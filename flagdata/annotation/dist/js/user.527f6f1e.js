(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{"0a1d":function(t,e,a){"use strict";var i=a("a3b5"),s=a.n(i);s.a},"0d20":function(t,e,a){},"12f8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"tag-box",staticStyle:{backgroundColor:"#f0f2f5"},attrs:{id:"tagBox"}},[i("div",{staticClass:"tag"},[i("div",{staticClass:"canvas-left"},[i("a-tabs",{staticClass:"backG-white fullHeight",attrs:{defaultActiveKey:"1"},model:{value:e.tabsKey,callback:function(t){e.tabsKey=t},expression:"tabsKey"}},[i("a-tab-pane",{key:"1",attrs:{tab:e.$t("tag.tag2"),"force-render":""}},[i("div",{staticStyle:{height:"100%"}},[i("div",{ref:"container",staticClass:"desiList"},[i("a-affix",{attrs:{target:function(){return t.$refs.container}}},[i("p",{staticClass:"title"},[i("span",[e._v(e._s(e.$t("tag.tag1")))]),"fileImage"===e.fileAttribute?i("a-icon",{staticClass:"UpList",attrs:{type:"redo",title:e.$t("tag.tag3")},on:{click:function(){t.$refs.childDraw.handleUpImage()}}}):e._e()],1)]),i("div",{staticClass:"line-main"},e._l(e.fileList,(function(t,a){return i("div",{key:a,class:{selectItem:e.selectItem===t.name,line:!0,alreadyTag:e.alreadyTag.indexOf(t.webkitRelativePath)>=0}},[i("p",{attrs:{title:t.name},on:{click:function(i){return e.handleSelectFile(t,a)}}},[e._v(e._s(t.name))])])})),0)],1)])]),i("a-tab-pane",{key:"2",attrs:{tab:e.$t("tag.tag4"),"force-render":""}},[i("div",{staticStyle:{height:"100%"}},[i("div",{ref:"container",staticClass:"desiList"},[i("a-affix",{attrs:{target:function(){return t.$refs.container}}},[i("p",{staticClass:"title"},[i("span",[e._v(e._s(e.$t("tag.tag5")))]),e.fromCenterVal?e._e():i("span",{staticClass:"aciton"},[e._v(e._s(e.$t("tag.tag6")))])])]),i("div",{staticClass:"line-main"},e._l(e.desiList,(function(t,a){return i("div",{key:a,staticClass:"line"},[i("span",[e._v(e._s(a+1)+":")]),i("p",{attrs:{title:t.descibe},on:{click:function(a){return e.handleDesi(t)}}},[e._v(e._s(t.descibe))]),e.fromCenterVal?e._e():i("a-dropdown",{attrs:{placement:"bottomCenter"}},[i("span",{staticClass:"action"},[i("a-icon",{attrs:{type:"setting"}})],1),i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},e._l(e.dropMenu,(function(a,s){return i("a-menu-item",{key:s,on:{click:function(i){return e.handleMenuClick(t,a)}}},[e._v(e._s(a.name)+" ")])})),1)],1)],1)})),0)],1)])])],1)],1),i("div",{staticClass:"center basi marLeft canvas-right fullHeight"},[i("Draw",{ref:"childDraw",attrs:{queryProId:e.queryProId},on:{handleSwitch:e.handleSwitch,desclistFn:e.desclistFn,clearDesFn:e.clearDesFn,subApi:e.subApi,allDesiListFn:e.allDesiListFn,handleGetFile:e.handleGetFile,handleGetFileImage:e.handleGetFileImage,listenModified:e.listenModified,deleteItem:e.deleteItem,listenColorChnange:e.listenColorChnange,listenobjectMoved:e.listenobjectMoved,"update:queryProId":function(t){e.queryProId=t},"update:query-pro-id":function(t){e.queryProId=t}}})],1)])])},s=[],n=(a("cb29"),a("4de4"),a("c975"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("53ca")),o=(a("a4d3"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("ade3"));function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}function d(t){if(Array.isArray(t))return c(t)}a("e01a"),a("d28b"),a("a630"),a("e260");function h(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}a("fb6a"),a("25f0");function f(t,e){if(t){if("string"===typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(t,e):void 0}}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t){return d(t)||h(t)||f(t)||u()}var m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"draw"}},[a("div",{attrs:{id:"canvasContent"}},[a("div",{staticClass:"top",staticStyle:{width:"100%",height:"100%"},attrs:{id:"top"}},[a("div",{staticClass:"canvasOut scroolSyle",staticStyle:{width:"100%",height:"100%"}},[a("canvas",{attrs:{id:"canvas",width:t.width,height:t.height}})])])]),a("DrawerTool",{ref:"childTool",staticClass:"DrawerTool",attrs:{isImage:t.isImage,isSelectDrawType:t.isSelectDrawType,CoefficientPosi:t.CoefficientPosi},on:{chanageSelectedColor:t.chanageSelectedColor,drawPolygon:t.drawPolygon,drawTypeChange:t.drawTypeChange,confirmClear:t.confirmClear,submitDraw:t.submitDraw,uploadImg:t.uploadImg,echoImg:t.handleEchoImg,drawEdit:t.drawEdit,restoration:t.restoration}})],1),a("TagDescribe",{attrs:{isVisiblea:t.isVisiblea},on:{"update:isVisiblea":function(e){t.isVisiblea=e},"update:is-visiblea":function(e){t.isVisiblea=e},descibeFn:t.descibeFn}}),a("ADrawer",{attrs:{isVisibleaDrawer:t.isVisibleaDrawer,changeSelectedColorVal:t.changeSelectedColorVal},on:{"update:isVisibleaDrawer":function(e){t.isVisibleaDrawer=e},"update:is-visiblea-drawer":function(e){t.isVisibleaDrawer=e},chanageSelectedColor:t.chanageSelectedColor}}),a("input",{attrs:{type:"file",id:"imgInput",accept:"image/jpe?g, image/png, image/bmp",webkitdirectory:""},on:{change:t.getFileImage}}),a("input",{attrs:{type:"file",id:"imgDataInputFolder",accept:".json",webkitdirectory:""},on:{change:t.getImgDataFolder}}),a("input",{attrs:{type:"file",id:"imgDataInputFile",accept:".json"},on:{change:t.getImgDataFile}})],1)},g=[],v=(a("99af"),a("caad"),a("13d5"),a("2532"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"out"},[a("div",{staticClass:"main scroolSyle",style:{width:t.width+"px"}},[a("p"),t._l(t.imgList,(function(e,i){return a("img",{key:i,staticClass:"img",attrs:{src:e.pictureUrl,alt:""},on:{click:function(a){return a.stopPropagation(),t.clickItem(e)}}})}))],2)])}),b=[],w=(a("a9e3"),{props:{width:{type:Number,default:500}},computed:{imgList:function(){return this.$store.state.labels.selectImgList}},data:function(){return{}},methods:{clickItem:function(t){this.$emit("bgChangeFn",t)}},components:{}}),y=w,x=(a("8074"),a("2877")),_=Object(x["a"])(y,v,b,!1,null,"998307f4",null),C=_.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:t.$t("tagDescribe.labelName"),closable:!1,maskClosable:!1,keyboard:!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.handleOk}},[t._v(" "+t._s(t.$t("determine"))+" ")])],1),a("a-textarea",{staticClass:"marTop",attrs:{placeholder:t.$t("tagDescribe.drawDescription"),"auto-size":{minRows:3,maxRows:5}},model:{value:t.describeVal,callback:function(e){t.describeVal=e},expression:"describeVal"}})],2)],1)},I=[],T={props:{isVisiblea:{type:Boolean,dafault:!1}},watch:{isVisiblea:function(t){this.visible=!1}},data:function(){return{visible:this.isVisiblea,describeVal:""}},methods:{close:function(){this.$emit("update:isVisiblea",!1),this.describeVal=""},handleOk:function(){this.describeVal?(this.$emit("descibeFn",this.describeVal),this.close()):this.$message.warning($t("tagDescribe.labelNameEmpty"))},cancelFn:function(t){this.describeVal?(this.$emit("descibeFn","标注"),this.close(),this.describeVal=""):this.$message.warning($t("tagDescribe.labelNameEmpty"))}},components:{}},S=T,L=Object(x["a"])(S,k,I,!1,null,"7cb671e7",null),A=L.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"drawTool"},[a("div",{staticClass:"backG-white"},[a("h2",[t._v(t._s(t.$t("drawerTool.drawerTool1")))]),a("div",{staticClass:"drawBtn"},[a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool2")))])]),t.isSelectDrawType||t.isPreservation?a("a-button",{staticClass:"btn-item",attrs:{type:"dashed"},on:{click:t.uploadImg}},[t._v(t._s(t.$t("drawerTool.drawerTool3")))]):a("a-popconfirm",{attrs:{placement:"bottom",title:t.$t("drawerTool.drawerTool4"),"ok-text":t.$t("drawerTool.drawerTool5"),"cancel-text":t.$t("drawerTool.drawerTool6")},on:{confirm:function(e){return t.submitDraw("sub","reUpLoad")},cancel:t.uploadImg}},[a("a-button",{staticClass:"btn-item",attrs:{type:"dashed"}},[t._v(t._s(t.$t("drawerTool.drawerTool3")))])],1)],2),t.isSelectDrawType||t.isPreservation?a("a-dropdown",{attrs:{placement:"bottomCenter"}},[a("a-button",{staticClass:"btn-item",attrs:{type:"dashed"}},[t._v(t._s(t.$t("drawerTool.drawerTool7")))]),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(e){return t.echoImg("file")}}},[a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool8")))])]),a("span",[t._v(t._s(t.$t("drawerTool.drawerTool9")))])],2)],1),a("a-menu-item",{on:{click:function(e){return t.echoImg("folder")}}},[a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool10")))])]),a("span",[t._v(t._s(t.$t("drawerTool.drawerTool11")))])],2)],1)],1)],1):a("a-popconfirm",{attrs:{placement:"bottom",title:t.$t("drawerTool.drawerTool4"),"ok-text":t.$t("drawerTool.drawerTool5"),"cancel-text":t.$t("drawerTool.drawerTool6")},on:{confirm:function(e){return t.submitDraw("sub","reEcho")},cancel:function(e){t.isPreservation=!0}}},[a("a-button",{staticClass:"btn-item",attrs:{type:"dashed"}},[t._v(t._s(t.$t("drawerTool.drawerTool7")))])],1),a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool12")))])]),a("a-button",{staticClass:"btn-item",class:{activeBtn:t.rectActiveStyle},attrs:{disabled:t.isSelectDrawType},on:{click:function(e){return t.drawTypeChange("rectangle")}}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool13"))+" ")])],2),a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool14")))])]),a("a-button",{staticClass:"btn-item",class:{activeBtn:t.polygonActiveStyle},attrs:{disabled:t.isSelectDrawType,type:"dashed"},on:{click:t.drawPolygon}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool15"))+" ")])],2),a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("drawerTool.drawerTool16")))])]),a("a-button",{staticClass:"btn-item",class:{activeBtn:t.editActiveStyle},attrs:{type:"dashed"},on:{click:t.drawEdit}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool17"))+" ")])],2)],1),a("div",{staticClass:"boderColor flexBasi tagColor"},[a("div",{staticStyle:{display:"inline-block"}},[t._v(t._s(t.$t("aDrawer.borderColor")))]),t._m(0)]),a("div",{staticClass:"fill flexBasi tagColor"},[a("div",{staticStyle:{display:"inline-block"}},[t._v(t._s(t.$t("aDrawer.fillColor")))]),t._m(1)]),a("div",{staticClass:"btn"},[a("a-popconfirm",{attrs:{placement:"bottom",title:t.$t("drawerTool.drawerTool18"),"ok-text":t.$t("drawerTool.drawerTool19"),"cancel-text":t.$t("drawerTool.drawerTool52")},on:{confirm:t.confirmClear,cancel:t.cancelClear}},[a("a-button",{staticClass:"btn-item",attrs:{type:"danger"}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool19"))+" ")])],1),a("a-button",{staticClass:"btn-item",attrs:{type:"primary",disabled:!t.isSubmit},on:{click:function(e){return t.submitDraw("sub")}}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool5"))+" ")])],1),a("div",{staticClass:"explain-main"},[a("div",{staticClass:"explain marTop"},[a("span",{staticClass:"explain-header"},[t._v(t._s(t.$t("drawerTool.drawerTool21")))]),a("p",[a("strong",[t._v(t._s(t.$t("drawerTool.drawerTool53")))]),a("span",[t._v(t._s(t.CoefficientPosi))])]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#C42B51"}},[t._v(t._s(t.$t("drawerTool.drawerTool22")))]),a("br"),a("b",[t._v(t._s(t.$t("drawerTool.drawerTool43")))]),t._v(t._s(t.$t("drawerTool.drawerTool23"))),a("br"),a("b",[t._v(t._s(t.$t("drawerTool.drawerTool44")))]),t._v(t._s(t.$t("drawerTool.drawerTool24"))),a("br"),a("b",[t._v(t._s(t.$t("drawerTool.drawerTool45")))]),t._v(t._s(t.$t("drawerTool.drawerTool25"))),a("br")]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#ff4d4f"}},[t._v(t._s(t.$t("drawerTool.drawerTool26")))]),a("br"),t._v(t._s(t.$t("drawerTool.drawerTool27")))]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#406DCF"}},[t._v(t._s(t.$t("drawerTool.drawerTool28")))]),a("br"),t._v(t._s(t.$t("drawerTool.drawerTool29"))),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool30")))])]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#6DD451"}},[t._v(t._s(t.$t("drawerTool.drawerTool31")))]),a("br"),t._v(t._s(t.$t("drawerTool.drawerTool32"))),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool33")))])]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#DBCB4F"}},[t._v(t._s(t.$t("drawerTool.drawerTool34")))]),a("br"),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool35")))]),t._v(t._s(t.$t("drawerTool.drawerTool54"))+" ")]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#DBCB4F"}},[t._v(t._s(t.$t("drawerTool.drawerTool36")))]),a("br"),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool37")))]),t._v(t._s(t.$t("drawerTool.drawerTool38"))+" "),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool39")))])]),a("p",{staticClass:"explain-item"},[a("span",{staticStyle:{color:"#F15A24"}},[t._v(t._s(t.$t("drawerTool.drawerTool40")))]),a("br"),t._v(t._s(t.$t("drawerTool.drawerTool41"))+" ")])]),a("div",{staticClass:"explain marTop"},[a("span",{staticClass:"explain-header"},[t._v(t._s(t.$t("drawerTool.drawerTool42")))]),a("p",{staticClass:"explain-item noPL"},[a("b",[t._v(t._s(t.$t("drawerTool.drawerTool43")))]),t._v(t._s(t.$t("drawerTool.drawerTool46"))),a("b",{staticStyle:{color:"red"}},[t._v(" "+t._s(t.$t("drawerTool.drawerTool47")))]),t._v(t._s(t.$t("drawerTool.drawerTool48"))+" "),a("br"),a("b",[t._v(" "+t._s(t.$t("drawerTool.drawerTool44")))]),t._v(t._s(t.$t("drawerTool.drawerTool49"))),a("br"),a("b",[t._v(t._s(t.$t("drawerTool.drawerTool45")))]),a("b",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("drawerTool.drawerTool50")))]),t._v(t._s(t.$t("drawerTool.drawerTool51"))+" ")])])])])])},D=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{attrs:{id:"color-border"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{attrs:{id:"color-picker"}})])}];let $=(t,e,a)=>(t.prototype[e]=a,t);const P=Object.create(null),j=Object.prototype.toString;["Number","String","Function","Undefined"].forEach(t=>P["is"+t]=e=>typeof e===t.toLowerCase()),P.addMethod=$,["Object","Array","RegExp"].forEach(t=>P["isDeep"+t]=e=>j.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()),P.isShallowObject=t=>"object"===typeof t&&!P.isNull(t),P["ewObjToArray"]=t=>P.isShallowObject(t)?Array.prototype.slice.call(t):t,P.isNull=t=>null===t,P.ewAssign=(t,e)=>{if(!P.isNull(t)){if(Object.assign)return Object.assign(t,e);{const e=Object(t);for(let t=1,a=arguments.length;t<a;t+=1){const a=arguments[t];if(a)for(let t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e}}},P.addClass=(t,e)=>t.classList.add(e),P.removeClass=(t,e)=>t.classList.remove(e),P["setCss"]=(t,e,a)=>t.style[e]=a,P.isDom=t=>P.isShallowObject(HTMLElement)?t instanceof HTMLElement:t&&P.isShallowObject(t)&&1===t.nodeType&&P.isString(t.nodeName)||t instanceof HTMLCollection||t instanceof NodeList,P.ewError=t=>console.error("[ewColorPicker warn]\n"+new Error(t)),P.deepCloneObjByJSON=t=>JSON.parse(JSON.stringify(t)),P.deepCloneObjByRecursion=function t(e){if(!P.isShallowObject(e))return;let a=P.isDeepArray(e)?[]:{};for(let i in e)a[i]=P.isShallowObject(e[i])?t(e[i]):e[i];return a},P.getCss=(t,e)=>{const a=t.currentStyle?function(e){const i=t.currentStyle[e];if(i.indexOf("height")>-1&&i.search(/px/i)>-1){const e=t.getBoundingClientRect;return e.bottom-e.top-parseInt(a("padding-bottom"))-parseInt(a("padding-top"))+"px"}}:function(e){return window.getComputedStyle(t,null)[e]};return a(e)},P.$=t=>document.querySelector(t),P["on"]=(t,e,a,i=!1)=>{t&&e&&a&&t.addEventListener(e,a,i)},P["off"]=(t,e,a,i=!1)=>{t&&e&&a&&t.removeEventListener(e,a,i)},P.eventType=navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];var E=P;function M(t){const e={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},a=function(t){t=Math.min(Math.round(t),255);const a=Math.floor(t/16),i=t%16;return""+(e[a]||a)+(e[i]||i)},i="#";if(/rgba?/.test(t)){let e=t.replace(/rgba?\(/,"").replace(/\)/,"").replace(/[\s+]/g,"").split(","),s="";return e.map((function(t,e){e<=2&&(s+=a(t))})),i+s}}function B(t,e){let a,i,s,n=t.a,o=Math.round(t.h),r=Math.round(255*t.s/100),l=Math.round(255*t.b/100);if(0===r)a=i=s=l;else{let t=l,e=(255-r)*l/255,n=o%60*(t-e)/60;360===o?(a=t,i=s=0):o<60?(a=t,i=e+n,s=e):o<120?(a=t-n,i=t,s=e):o<180?(a=e,i=t,s=e+n):o<240?(a=e,i=t-n,s=t):o<300?(a=e+n,i=e,s=t):o<360?(a=t,i=e,s=t-n):a=i=s=0}return(e>=0||e<=1)&&(n=e),"rgba("+Math.round(a)+","+Math.round(i)+","+Math.round(s)+","+n+")"}function F(t){const e=t.slice(t.indexOf("(")+1,t.lastIndexOf(")")).split(",");let a,i,s,n=e.length<4?1:Number(e[3]),o=Number(e[0])/255,r=Number(e[1])/255,l=Number(e[2])/255,c=Math.min(o,r,l),d=s=Math.max(o,r,l),h=d-c;if(d===c)a=0;else{switch(d){case o:a=(r-l)/h+(r<l?6:0);break;case r:a=2+(l-o)/h;break;case l:a=4+(o-r)/h;break}a=Math.round(60*a)}return i=0===d?0:1-c/d,i=Math.round(100*i),s=Math.round(100*s),{h:a,s:i,b:s,a:n}}function R(t){const e=document.createElement("div");e.style.backgroundColor=t,document.body.appendChild(e);const a=window.getComputedStyle(e).backgroundColor;return document.body.removeChild(e),a.slice(0,2)+"ba"+a.slice(3,a.length-1)+", 1)"}function z(t){const e=/^#([0-9a-f]{6}|[0-9a-f]{3})$/i,a=/^rgb\(([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\)$/i,i=/^rgba\(([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,([0-9]|[0-9][0-9]|25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9])\,(1|1.0|0.[0-9])\)$/i;return a.test(t)||e.test(t)||i.test(t)}const V={};function U(){this.timers=[],this.args=[],this.isTimerRun=!1}U.makeTimerManage=function(t){const e=t.TimerManage;e&&e.constructor===U||(t.TimerManage=new U)};const N=[{method:"add",func:function(t,e){this.timers.push(t),this.args.push(e),this.timerRun()}},{method:"timerRun",func:function(){if(!this.isTimerRun){let t=this.timers.shift(),e=this.args.shift();t&&e&&(this.isTimerRun=!0,t(e[0],e[1]))}}},{method:"next",func:function(){this.isTimerRun=!1,this.timerRun()}}];function W(t){const e=t.TimerManage;e&&e.constructor===U&&e.next()}function J(t,e,a){let i="",s="";function n(){const i=t.toLowerCase().indexOf("down")>-1;i&&E.setCss(e,"display","block");let s=e.offsetHeight,n=i?0:s,o=s/(a/10);i&&E.setCss(e,"height","0px");let r=setInterval(()=>{n=i?n+o:n-o,E.setCss(e,"height",n+"px"),(n>=s||n<=0)&&(clearInterval(r),E.setCss(e,"height",s+"px"),W(e)),!i&&n<=0&&E.setCss(e,"display","none")},10)}function o(){const i=t.toLowerCase().indexOf("in")>-1;let s=null,n=100/(a/10),o=i?0:100;E.setCss(e,"display",i?"none":"block"),E.setCss(e,"opacity",i?0:1);let r=function(){o=i?o+n:o-n,"none"===e.style.display&&i&&E.setCss(e,"display","block"),E.setCss(e,"opacity",(o/100).toFixed(2)),o>=100||o<=0?(s&&clearTimeout(s),W(e),o<=0&&E.setCss(e,"display","none"),E.setCss(e,"opacity",o>=100?1:0)):s=setTimeout(r,10)};r()}t.indexOf("slide")>-1?(i="height"+a+" ms",s="hidden",n()):(i="opacity"+a+" ms",s="",o()),s&&E.setCss(e,"overflow",s),E.setCss(e,"transition",i)}N.forEach(t=>E.addMethod(U,t.method,t.func)),["slideUp","slideDown","fadeIn","fadeOut"].forEach(t=>{V[t]=function(e){U.makeTimerManage(e),e.TimerManage.add((function(e,a){return J(t,e,a)}),arguments)}});var q=V;const X=()=>console.log("%c ew-color-picker@1.5.6%c 联系QQ：854806732 %c 联系微信：eveningwater %c github:https://github.com/eveningwater/ew-color-picker %c ","background:#0ca6dc ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#ff7878 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent");a("82c1");const Y=["html","head","body","meta","title","link","style","script"],H={PICKER_OBJECT_CONFIG_ERROR:"you should pass a param which is el and el must be a string or a dom element!",PICKER_CONFIG_ERROR:"you should pass a param that it must be a string or a dom element!",DOM_OBJECT_ERROR:"can not find the element by el property,make sure to pass a correct value!",DOM_ERROR:"can not find the element,make sure to pass a correct param!",CONFIG_SIZE_ERROR:"the value must be a string which is one of the normal,medium,small,mini,or must be an object and need to contain width or height property!",DOM_NOT_ERROR:"Do not pass these elements: "+Y.join(",")+" as a param,pass the correct element such as div!",PREDEFINE_COLOR_ERROR:"PredefineColor is a array that is need to contain color value!",CONSTRUCTOR_ERROR:"ewColorPicker is a constructor and should be called with the new keyword"};function G(t){if(E.isUndefined(new.target))return E.ewError(H.CONSTRUCTOR_ERROR);const e=function(){},a={hue:!0,alpha:!1,size:"normal",predefineColor:[],disabled:!1,defaultColor:"",openPickerAni:"height",sure:e,clear:e,openPicker:e,isLog:!0};if(this.boxSize={b_width:null,b_height:null},E.isString(t)||E.isDom(t))this.config=a,this.beforeInit(t,this.config,H.DOM_ERROR);else{if(!E.isDeepObject(t)||!E.isString(t.el)&&!E.isDom(t.el)){const e=E.isDeepObject(t)?H.PICKER_OBJECT_CONFIG_ERROR:H.PICKER_CONFIG_ERROR;return E.ewError(e)}this.config=E.ewAssign(a,t),this.beforeInit(t.el,this.config,H.DOM_OBJECT_ERROR)}return this.config.pickerFlag=!1,this}const Z=[{name:"beforeInit",func:function(t,e,a){e.isLog&&X();const i=t=>Y.indexOf(t.tagName.toLowerCase())>-1&&(E.ewError(H.DOM_NOT_ERROR),!0),s=E.isDom(t)?t:E.isString(t)?E.$(t):null;if(s)if(s.length)E.ewObjToArray(s).forEach(t=>{i(t)||this.init(t,e)});else{if(!s.tagName)return E.ewError(a);i(s)||this.init(s,e)}else E.ewError(a)}},{name:"init",func:function(t,e){let a,i;if(E.isString(e.size))switch(e.size){case"normal":a=i="40px";break;case"medium":a=i="36px";break;case"small":a=i="32px";break;case"mini":a=i="28px";break;default:a=i="40px";break}else{if(!E.isDeepObject(e.size))return E.ewError(H.CONFIG_SIZE_ERROR);a=e.size.width&&E.isNumber(e.size.width)?parseInt(e.size.width)+"px":"40px",i=e.size.height&&E.isNumber(e.size.height)?parseInt(e.size.height)+"px":"40px"}this.boxSize.b_width=a,this.boxSize.b_height=i,this.render(t,e)}},{name:"render",func:function(t,e){let a="",i="",s="",n="",o="";const r=e.predefineColor;if(!E.isDeepArray(r))return E.ewError(H.PREDEFINE_COLOR_ERROR);r.length&&r.map(t=>{z(t)&&(a+=`<div class="ew-pre-define-color" style="background:${t};"></div>`)});const l=e.defaultColor?`<div class="ew-color-picker-arrow" style="width:${this.boxSize.b_width};height:${this.boxSize.b_height};">\n                <div class="ew-color-picker-arrow-left"></div>\n                <div class="ew-color-picker-arrow-right"></div>\n            </div>`:`<div class="ew-color-picker-no" style="width:${this.boxSize.b_width};height:${this.boxSize.b_height};line-height:${this.boxSize.b_height};">&times;</div>`;e.alpha&&(i='<div class="ew-alpha-slider-bar">\n                    <div class="ew-alpha-slider-wrapper"></div>\n                    <div class="ew-alpha-slider-bg"></div>\n                    <div class="ew-alpha-slider-thumb"></div>\n                </div>'),e.hue&&(s='<div class="ew-color-slider-bar"><div class="ew-color-slider-thumb"></div></div>'),a&&(n=`<div class="ew-pre-define-color-container">${a}</div>`),e.disabled&&(o="ew-color-picker-box-disabled");const c=`width:${this.boxSize.b_width};height:${this.boxSize.b_height};${e.defaultColor&&!e.disabled?"background:"+e.defaultColor:""}`,d=`\n                <div class="ew-color-picker-box ${o}" tabIndex="0" style="${c}">${l}</div>\n                <div class="ew-color-picker">\n                    <div class="ew-color-picker-content">\n                        <div class="ew-color-slider">${i}${s}</div>\n                        <div class="ew-color-panel" style="background:red;">\n                            <div class="ew-color-white-panel"></div>\n                            <div class="ew-color-black-panel"></div>\n                            <div class="ew-color-cursor"></div>\n                        </div>\n                    </div>\n                    <div class="ew-color-drop-container">\n                        <input type="text" class="ew-color-input">\n                        <div class="ew-color-drop-btn-group">\n                            <button class="ew-color-clear ew-color-drop-btn">清空</button>\n                            <button class="ew-color-sure ew-color-drop-btn">确定</button>\n                        </div>\n                    </div>\n                    ${n}\n                </div>`;t.innerHTML=d,this.startMain(t,e)}},{name:"startMain",func:function(t,e){let a=this;this.box=K(t,"ew-color-picker-box"),this.arrowRight=K(t,"ew-color-picker-arrow-right"),this.pickerPanel=K(t,"ew-color-panel"),this.pickerCursor=K(t,"ew-color-cursor"),this.pickerInput=K(t,"ew-color-input"),this.pickerClear=K(t,"ew-color-clear"),this.pickerSure=K(t,"ew-color-sure"),this.hueBar=K(t,"ew-color-slider-bar"),this.hueThumb=K(t,"ew-color-slider-thumb"),this.picker=K(t,"ew-color-picker"),this.slider=K(t,"ew-color-slider"),this.hsbColor=this.config.defaultColor?F(R(this.config.defaultColor)):{h:0,s:100,b:100,a:1};const i=this.panelWidth=parseInt(E.getCss(this.pickerPanel,"width")),s=this.panelHeight=parseInt(E.getCss(this.pickerPanel,"height"));let n=t,o=n.offsetTop,r=n.offsetLeft;while(n.offsetParent)o+=n.offsetParent.offsetTop,r+=n.offsetParent.offsetLeft,n=n.offsetParent;if(this.panelLeft=r,this.panelTop=o+t.offsetHeight,this.preDefineItem=K(t,"ew-pre-define-color",!0),this.preDefineItem.length){const t=E.ewObjToArray(this.preDefineItem);t.map(e=>{const n=e=>{t.forEach(t=>E.removeClass(t,"ew-pre-define-color-active")),E.addClass(e.target,"ew-pre-define-color-active"),a.hsbColor=F(E.getCss(e.target,"background-color")),dt(a,i,s),ct(a),ot(a);const n=M(E.getCss(e.target,"background-color"));a.pickerInput.value=a.config.alpha?R(n):n},o=t=>E.removeClass(t.target,"ew-pre-define-color-active");[{type:"click",handler:n},{type:"blur",handler:o}].forEach(t=>E.on(e,t.type,t.handler))})}const l=e.openPickerAni.indexOf("height")>-1;this.picker.style[l?"display":"opacity"]=l?"none":0;const c=e.alpha||e.hue?e.alpha&&e.hue?27:14:0,d=e.alpha||e.hue?e.alpha&&e.hue?320:300:280;this.slider.style.width=c+"px",this.picker.style.minWidth=d+"px",e.alpha&&(this.alphaBar=K(t,"ew-alpha-slider-bar"),this.alphaBarBg=K(t,"ew-alpha-slider-bg"),this.alphaBarThumb=K(t,"ew-alpha-slider-thumb"),ct(this),this.bindEvent(this.alphaBarThumb,(t,e,a,i)=>ft(t,i)),E.on(this.alphaBar,"click",t=>ft(a,t.y))),E.on(this.pickerInput,"blur",t=>et(a,t.target.value)),E.on(this.pickerClear,"click",()=>at(t,a)),E.on(this.pickerSure,"click",()=>st(a)),e.disabled||E.on(this.box,"click",()=>Q(t,a)),E.on(this.pickerPanel,"click",t=>rt(a,t)),this.bindEvent(this.pickerCursor,(t,e,a,n)=>{const o=Math.max(0,Math.min(a-t.panelLeft,i)),r=Math.max(0,Math.min(n-t.panelTop,s));nt(t,o+4,r+4,i,s)}),e.hue&&(E.on(this.hueBar,"click",t=>ht(a,t.y)),this.bindEvent(this.hueThumb,(t,e,a,i)=>ht(t,i)))}},{name:"bindEvent",func:function(t,e,a){const i=this,s=s=>{i.moveX=E.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientX:s.clientX,i.moveY=E.eventType[0].indexOf("touch")>-1?s.changedTouches[0].clientY:s.clientY,a?e(i,i.moveX,i.moveY):e(i,t,i.moveX,i.moveY)},n=()=>{const t=t=>{t.preventDefault(),s(t)},e=()=>{E.off(document,E.eventType[1],t),E.off(document,E.eventType[2],e)};E.on(document,E.eventType[1],t),E.on(document,E.eventType[2],e)};E.on(t,E.eventType[0],n)}}];function K(t,e,a){return a?t.querySelectorAll("."+e):t.querySelector("."+e)}function Q(t,e){e.config.pickerFlag=!e.config.pickerFlag,e.config.defaultColor=e.config.alpha?B(e.hsbColor):M(B(e.hsbColor)),e.render(t,e.config),dt(e,e.panelWidth,e.panelHeight),tt(e),E.isFunction(e.config.openPicker)&&e.config.openPicker(t,e)}function tt(t){const e=E.isString(t.config.openPickerAni)&&t.config.openPickerAni.indexOf("height")>-1,a=()=>q[e?"slideDown":"fadeIn"](t.picker,200),i=()=>q[e?"slideUp":"fadeOut"](t.picker,200);return t.config.pickerFlag?a():i()}function et(t,e){const a=F(R(e));(a.h||a.s||a.h||a.a)&&(t.hsbColor=a,dt(t,t.panelWidth,t.panelHeight),ot(t))}function at(t,e){it(t,e),tt(e),e.config.clear(e.config.defaultColor,e)}function it(t,e){e.config.defaultColor="",e.config.pickerFlag=!e.config.pickerFlag,e.render(t,e.config)}function st(t){t.config.pickerFlag=!1,tt(t),ot(t);const e=t.config.alpha?B(t.hsbColor):M(B(t.hsbColor));t.config.sure(e,t)}function nt(t,e,a,i,s){E.setCss(t.pickerCursor,"left",e+"px"),E.setCss(t.pickerCursor,"top",a+"px");const n=parseInt(100*(e-4)/i),o=parseInt(100*(s-(a-4))/s);t.hsbColor.s=n>100?100:n<0?0:n,t.hsbColor.b=o>100?100:o<0?0:o,ot(t)}function ot(t,e){const a=B(t.hsbColor);E.setCss(t.box,"background",a),t.pickerInput.value=e||t.config.alpha?a:M(a)}function rt(t,e){if(e.target!==t.pickerCursor){const a=e.layerX,i=e.layerY,s=t.pickerPanel.offsetWidth,n=t.pickerPanel.offsetHeight,o=a>=s-1?s:a<=0?0:a,r=i>=n-2?n:i<=0?0:i;nt(t,o+4,r+4,s,n)}}function lt(t){const e=E.deepCloneObjByRecursion(t);return e.s=e.b=100,e}function ct(t){t.alphaBarBg&&E.setCss(t.alphaBarBg,"background","linear-gradient(to top,"+B(lt(t.hsbColor),0)+" 0%,"+B(lt(t.hsbColor))+" 100%)")}function dt(t,e,a){t.pickerInput.value=t.config.alpha?B(t.hsbColor):M(B(t.hsbColor));let i=0,s=parseInt(t.hsbColor.s*e/100),n=parseInt(a-t.hsbColor.b*a/100);[{el:t.pickerCursor,prop:"left",value:s+4+"px"},{el:t.pickerCursor,prop:"top",value:n+4+"px"},{el:t.pickerPanel,prop:"background",value:M(B(lt(t.hsbColor)))}].forEach(t=>E.setCss(t.el,t.prop,t.value)),t.box&&(t.box.style.background=t.pickerInput.value),t.config.hue&&(i=t.hueBar.offsetHeight||180,E.setCss(t.hueThumb,"top",parseInt(t.hsbColor.h*i/360)+"px")),t.config.alpha&&(t.config.hue||(i=t.alphaBar.offsetHeight||180),E.setCss(t.alphaBarThumb,"top",i-t.hsbColor.a*i+"px"))}function ht(t,e){const a=t.hueBar.offsetHeight,i=t.hueBar.getBoundingClientRect(),s=Math.max(0,Math.min(e-i.y,a));E.setCss(t.hueThumb,"top",s+"px"),t.hsbColor.h=lt(t.hsbColor).h=parseInt(360*s/a),E.setCss(t.pickerPanel,"background",M(B(lt(t.hsbColor)))),ot(t),ct(t)}function ft(t,e){const a=t.alphaBar.offsetHeight,i=t.alphaBar.getBoundingClientRect(),s=Math.max(0,Math.min(e-i.y,a));E.setCss(t.alphaBarThumb,"top",s+"px");const n=(a-s<=0?0:a-s)/a;t.hsbColor.a=n>=1?1:n.toFixed(2),ot(t,!0)}Z.forEach(t=>E.addMethod(G,t.name,t.func));var ut=G,pt=a("4628"),mt={props:{changeSelectedColorVal:{type:Object,default:function(){}},isSelectDrawType:{type:Boolean,default:!0},isImage:{type:Boolean,default:!1},CoefficientPosi:{type:Number,default:0}},computed:{fillColor:function(){return this.$store.state.labels.fillColor},borderColor:function(){return this.$store.state.labels.borderColor},currentProId:function(){return this.$store.state.labels.currentProId}},watch:{isImage:function(t,e){this.isPreservation=!t}},data:function(){return{colorPicker:null,isSubmit:!1,hasSelectDrawType:"0",isPreservation:!0,rectActiveStyle:!1,polygonActiveStyle:!1,editActiveStyle:!1,preDrawType:null}},mounted:function(){this.hasSelectDrawType="0",this.initFillColor(),this.initBorderColor()},methods:{uploadImg:function(){this.$emit("uploadImg",{selectTabs:"1",selectItem:0,fileAttribute:"fileImage"}),this.isSubmit=!0},echoImg:function(t){this.$emit("echoImg",{selectTabs:"1",selectItem:0,fileAttribute:"file",selectType:t}),this.isSubmit=!0},initFillColor:function(){var t=this,e=this;this.$nextTick((function(){t.colorPicker=new ut({el:"#color-picker",size:{width:200,height:32},isLog:!1,alpha:!0,defaultColor:t.fillColor,predefineColor:["#fff","#2396ef"],sure:e.handler,clear:e.clearColor,openPickerAni:"opacity"})}))},initBorderColor:function(){var t=this,e=this;this.$nextTick((function(){t.borderColorPicker=new ut({el:"#color-border",size:{width:200,height:32},isLog:!1,alpha:!1,defaultColor:t.borderColor,predefineColor:["#fff","#2396ef"],sure:e.sureBorder,clear:e.clearColorBorder,openPickerAni:"opacity"})}))},handler:function(t){this.$store.commit(pt["e"],t),this.changeSelectedColorVal.id&&(this.changeSelectedColorVal.fill=t,this.$emit("chanageSelectedColor",this.changeSelectedColorVal))},clearColor:function(){this.$store.commit(pt["e"],"rgba(255, 255, 255, 0)")},sureBorder:function(t){this.$store.commit(pt["b"],t),this.changeSelectedColorVal.id&&(this.changeSelectedColorVal.stroke=t,this.$emit("chanageSelectedColor",this.changeSelectedColorVal))},clearColorBorder:function(){this.$store.commit(pt["b"],"#0439a9")},drawPolygon:function(){this.hasSelectDrawType="2",this.rectActiveStyle=!1,this.polygonActiveStyle=!0,this.editActiveStyle=!1,this.preDrawType="polygon",this.$emit("drawPolygon","")},drawTypeChange:function(t){this.hasSelectDrawType="1",this.rectActiveStyle=!0,this.polygonActiveStyle=!1,this.editActiveStyle=!1,this.preDrawType=t,this.$emit("drawTypeChange",t)},confirmClear:function(){this.$emit("confirmClear",""),this.editActiveStyle=!1},cancelClear:function(){this.$emit("cancelClear","")},submitDraw:function(t,e){"reUpLoad"===e?this.uploadImg():"reEcho"===e&&this.echoImg(),this.$emit("submitDraw",t)},drawEdit:function(){this.rectActiveStyle=!1,this.polygonActiveStyle=!1,this.editActiveStyle=!this.editActiveStyle,this.$emit("drawEdit","")},restoration:function(){this.$emit("restoration","")},notActive:function(){this.rectActiveStyle=!1,this.polygonActiveStyle=!1}},components:{}},gt=mt,vt=(a("7268"),Object(x["a"])(gt,O,D,!1,null,"0be7a596",null)),bt=vt.exports,wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{title:t.$t("drawerTool.drawerTool55"),placement:"right",visible:t.visible,width:370,"after-visible-change":t.afterVisibleChange},on:{close:t.onClose}},[a("div",{staticClass:"handle-term"},[a("div",{staticClass:"tagname"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.$t("aDrawer.labelName")))]),a("a-input",{staticClass:"container marLeft10",attrs:{placeholder:t.$t("drawerTool.drawerTool56")},on:{change:t.changeFn},model:{value:t.tagName,callback:function(e){t.tagName=e},expression:"tagName"}})],1),a("div",{staticClass:"boderColor flexBasi adrawer",staticStyle:{marginTop:"6px"}},[a("div",{staticClass:"item-title"},[t._v(t._s(t.$t("aDrawer.borderColor")))]),a("div",{staticClass:"container"},[a("div",{attrs:{id:"colorBorder"}})])]),a("div",{staticClass:"fill flexBasi adrawer"},[a("div",{staticClass:"item-title"},[t._v(t._s(t.$t("aDrawer.fillColor")))]),a("div",{staticClass:"container"},[a("div",{attrs:{id:"colorPicker"}})])])]),a("div",{staticClass:"handle-explain"},[a("div",{staticClass:"title"},[t._v(t._s(t.$t("aDrawer.operatingInstructions")))]),a("div",{staticClass:"content"},[a("div",{staticClass:"explain-item"},[a("b",[t._v("1、")]),a("span",{staticStyle:{color:"#6DD451","font-weight":"600"}},[t._v(t._s(t.$t("aDrawer.labelName2")))]),t._v(t._s(t.$t("aDrawer.inputLabelImediately"))+" ")]),a("div",{staticClass:"explain-item"},[a("b",[t._v("2、")]),a("span",{staticStyle:{color:"#406DCF","font-weight":"600"}},[t._v(t._s(t.$t("aDrawer.borderColor2")))]),t._v(t._s(t.$t("aDrawer.relevantValueChange"))+" ")]),a("div",{staticClass:"explain-item"},[a("b",[t._v("3、")]),a("span",{staticStyle:{color:"#C42B51","font-weight":"600"}},[t._v(t._s(t.$t("aDrawer.fillColor2")))]),t._v(t._s(t.$t("aDrawer.relevantValueChange2"))+" ")])])]),a("div",{staticClass:"handle-explain"},[a("div",{staticClass:"title"},[t._v(t._s(t.$t("aDrawer.mattersNeedingAttention")))]),a("div",{staticClass:"content"},[a("div",{staticClass:"explain-item"},[a("b",[t._v("1、")]),a("span",{staticClass:"care"},[t._v(t._s(t.$t("aDrawer.clearOperation")))]),t._v(t._s(t.$t("aDrawer.selectedDefaultColor"))+" ")]),a("div",{staticClass:"explain-item"},[a("b",[t._v("2、")]),a("span",{staticClass:"care"},[t._v(t._s(t.$t("aDrawer.transparency")))]),t._v(t._s(t.$t("aDrawer.transparencyDefaultSelecting"))+" ")]),a("div",{staticClass:"explain-item"},[a("b",[t._v("3、")]),a("span",{staticClass:"care"},[t._v(t._s(t.$t("aDrawer.quickColors")))]),t._v(t._s(t.$t("aDrawer.selectorOperation"))+" ")])])])])},yt=[],xt={props:{isVisibleaDrawer:{type:Boolean,default:!1},changeSelectedColorVal:{type:Object,default:function(){}}},watch:{isVisibleaDrawer:function(t){this.visible=t,t&&(this.initFillColor(),this.initBorderColor(),this.tagName=this.changeSelectedColorVal.descibe)}},computed:{fillColor:function(){return this.$store.state.labels.fillColor},borderColor:function(){return this.$store.state.labels.borderColor}},data:function(){return{visible:this.isVisibleaDrawer,colorPicker:null,borderColorPicker:null,tagName:""}},methods:{initFillColor:function(){var t=this;t.$nextTick((function(){t.colorPicker=new ut({el:"#colorPicker",size:{width:200,height:32},isLog:!1,alpha:!0,defaultColor:t.fillColor,predefineColor:["#fff","#2396ef"],openPickerAni:"opacity",sure:t.handler,clear:t.clearColor})}))},initBorderColor:function(){var t=this;t.$nextTick((function(){t.borderColorPicker=new ut({el:"#colorBorder",size:{width:200,height:32},isLog:!1,alpha:!1,defaultColor:t.borderColor,predefineColor:["#fff","#2396ef"],openPickerAni:"opacity",sure:t.sureBorder,clear:t.clearColorBorder})}))},sureBorder:function(t){this.$store.commit(pt["b"],t),this.changeSelectedColorVal.id&&(this.changeSelectedColorVal.stroke=t,this.$emit("chanageSelectedColor",this.changeSelectedColorVal))},clearColorBorder:function(t){this.$store.state.labels.borderColor="",this.$store.commit(pt["b"],"#ff0000")},handler:function(t){this.$store.commit(pt["e"],t),this.changeSelectedColorVal.id&&(this.changeSelectedColorVal.fill=t,this.$emit("chanageSelectedColor",this.changeSelectedColorVal))},clearColor:function(t){this.$store.state.labels.fillColor="",this.$store.commit(pt["e"],"rgba(255, 0, 0, 0)")},afterVisibleChange:function(t){},onClose:function(){this.$emit("update:isVisibleaDrawer",!1)},changeFn:function(t){this.changeSelectedColorVal.descibe=this.tagName,this.$emit("changeTagName",this.changeSelectedColorVal)}},components:{}},_t=xt,Ct=(a("4716"),Object(x["a"])(_t,wt,yt,!1,null,"1d1bf8f4",null)),kt=Ct.exports;function It(t,e,a){var i=a.points[this.pointIndex].x-a.pathOffset.x,s=a.points[this.pointIndex].y-a.pathOffset.y;return fabric.util.transformPoint({x:i,y:s},fabric.util.multiplyTransformMatrices(a.canvas.viewportTransform,a.calcTransformMatrix()))}function Tt(t,e,a,i){var s=e.target,n=s.controls[s.__corner],o=s.toLocalPoint(new fabric.Point(a,i),"center","center"),r=s._getNonTransformedDimensions(),l=s._getTransformedDimensions(0,0),c={x:o.x*r.x/l.x+s.pathOffset.x,y:o.y*r.y/l.y+s.pathOffset.y};return s.points[n.pointIndex]=c,!0}function St(t,e){return function(a,i,s,n){var o=i.target,r=fabric.util.transformPoint({x:o.points[t].x-o.pathOffset.x,y:o.points[t].y-o.pathOffset.y},o.calcTransformMatrix()),l=e(a,i,s,n),c=(o._setPositionDimensions({}),o._getNonTransformedDimensions()),d=(o.points[t].x-o.pathOffset.x)/c.x,h=(o.points[t].y-o.pathOffset.y)/c.y;return o.setPositionByOrigin(r,d+.5,h+.5),l}}var Lt,At,Ot,Dt=a("2875"),Pt=a.n(Dt),jt=a("5d3d"),Et=a.n(jt),Mt={x:0,y:0},Bt=(new fabric.Image.filters.Resize({scaleX:1,scaleY:1,resizeType:"lanczos",lanczosLobes:3}),{props:{queryProId:{type:String,default:""}},data:function(){return{width:1248,height:689,outWidth:1250,drawType:null,moveCount:1,doDrawing:!1,mouseTo:{},mouseFrom:{},drawWidth:1,drawingObject:null,isVisibleDialog:!1,jsonData:{},isVisiblea:!1,paddingLft:"200px",marTop:"100px",canvasBg:"",drawCanDia:!0,isEdit:!0,curentDataSetId:"",currentImgId:"",currentAction:"项目操作",inspectInfor:"",inspectTimes:0,inspectTagId:"",polygonMode:!1,pointArray:[],lineArray:[],activeShape:!1,activeLine:"",line:{},scaleNum:100,isVisibleaDrawer:!1,moveCanvasInfo:{isDragging:!1,lastX:0,lastY:0},zoom:window.zoom?window.zoom:1,beginzoomPoint:new fabric.Point(0,0),zoomPoint:new fabric.Point(0,0),lastzoomPoint:{x:0,y:0},lastmousePoint:{x:0,y:0},lastzoom:1,relativeMouseX:0,relativeMouseY:0,copycanvas:{},copycontext:null,square:null,squaredata:{},canvasSource:null,boxSource:null,changeSelectedColorVal:{},bgImgX:0,bgImgY:0,bgImgLeftTopX:0,bgImgLeftBottomY:0,bgWidth:0,bgHeight:0,imgFile:{},imgSrc:"",dataList:[],isSelectDrawType:!0,isImage:!1,isDrawEdit:!1,isCanCtrlFlag:!1,CoefficientPosi:0,preEdit:!1,SelectFileList:[],SelectFile:{},preDrawType:"",isMoveScal:!1}},computed:{imgList:function(){return this.$store.state.labels.selectImgList},currentProId:function(){return this.$store.state.labels.currentProId},fromCenterVal:function(){return this.$store.state.labels.fromCenterVal},currentSelectedImg:function(){return this.$store.state.labels.currentSelectedImg},fillColor:function(){return this.$store.state.labels.fillColor},color:function(){return this.$store.state.labels.borderColor}},watch:{drawType:function(){this.canvas.selection=!this.drawType},width:function(t){this.canvas.setWidth(t)},height:function(){this.canvas.setHeight(this.height)},currentSelectedImg:function(t){this.bgChangeFn(t)}},mounted:function(){var t=this;this.init(),this.keyboardFn(),this.widthChange(),window.onresize=function(){t.widthChange()},this.width=document.getElementById("top").clientWidth-2,this.height=document.getElementById("top").clientHeight-2},methods:{uploadImg:function(t){this.$emit("handleSwitch",l({},t)),this.clearBgAll(),document.getElementById("imgInput").click()},handleEchoImg:function(t){this.SelectFile={},"file"===t.selectType?(t.selectTabs="2",t.selectItem="",document.getElementById("imgDataInputFile").click()):document.getElementById("imgDataInputFolder").click(),this.$emit("handleSwitch",l({},t)),this.clearBgAll()},getImgDataFile:function(t){var e=this,a=this;a.isImage=!1;var i=document.getElementById("imgDataInputFile"),s=new Image,n=t.target.files[0];if(n){var o=n,r=o.name;a.imgTitle=r;var l=new FileReader;l.readAsText(o),l.onload=function(){var t=JSON.parse(this.result);t.imgUrl||this.$message.warning($t("draw.selectJsonFile")),s.src=t.imgUrl,a.canvasBg=t.imgUrl,a.clearAllDraw(),a.clearBgAll(),t.desiList?(a.dataList=p(t.desiList),a.dataList.forEach((function(t){"polygon"===t.type?a.showPolygon(t):a.showRectangle(t)})),i.value=""):a.$message.error($t("draw.dataFormatIncorrect"))},s.onload=function(){new fabric.Image(s,{zIndex:-1});a.isImage=!0,a.setCanvasBg(e.canvasBg),a.isSelectDrawType=!1,a.$emit("allDesiListFn",a.dataList)}}else this.$message.warning($t("draw.selectAgain"))},getImgDataFolder:function(t){var e=this,a=this,i=[];a.isImage=!1;var s=l({},t.target.files),n=[];for(var o in s)s[o].name.includes(".json")&&(i.push(s[o]),n.push(s[o].webkitRelativePath));localStorage.setItem("LocalStragePaths",JSON.stringify(n)),this.$emit("handleGetFile",{list:i,type:"file"});var r=l({title:"",type:""},JSON.parse(localStorage.getItem("selcetFileIndex"))),c=r.title,d=r.type;i.forEach((function(t,a){return t.name===c?i.length>=a&&"file"===d?(e.loadEchoImage(i[a]),!1):(e.loadEchoImage(i[0]),!1):a===i.length-1&&t.name!==c&&"file"!==d?(e.loadEchoImage(i[0]),!1):void 0}))},loadEchoImage:function(t){var e=this;if(t){var a=this,i=document.getElementById("imgDataInputFolder"),s=new Image,n=t,o=n.name;a.imgTitle=o;var r=new FileReader;r.readAsText(n),r.onload=function(){var t=JSON.parse(this.result);t.imgUrl||this.$message.warning($t("draw.selectJsonFile")),s.src=t.imgUrl,a.canvasBg=t.imgUrl,a.clearAllDraw(),a.clearBgAll(),t.desiList?(a.dataList=p(t.desiList),a.dataList.forEach((function(t){"polygon"===t.type?a.showPolygon(t):a.showRectangle(t)})),i.value=""):a.$message.error($t("draw.dataFormatIncorrect"))},s.onload=function(){new fabric.Image(s,{zIndex:-1});a.isImage=!0,a.setCanvasBg(e.canvasBg),a.isSelectDrawType=!1,a.$emit("allDesiListFn",a.dataList)}}else this.$message.warning($t("draw.selectAgain"))},getFileImage:function(t){var e=this,a=this,i=[];a.isImage=!1;var s=t.target.files;for(var n in this.SelectFileList=[],s)/\.(jpe?g|png|bmp)$/i.test(s[n].name)&&(i.push(s[n]),this.SelectFileList.push(s[n]));this.$emit("handleGetFileImage",{list:i,type:"fileImage"});var o=l({title:"",type:""},JSON.parse(localStorage.getItem("selcetFileIndex"))),r=o.title,c=o.type;i.forEach((function(t,a){return t.name===r?i.length>=a&&"fileImage"===c?(e.loadUploadImage(i[a]),!1):(e.loadUploadImage(i[0]),!1):a===i.length-1&&t.name!==r&&"fileImage"!==c?(e.loadUploadImage(i[0]),!1):void 0}))},loadUploadImage:function(t){var e=this;if(t){var a=this,i=document.getElementById("imgInput");a.SelectFile=t;var s=new Image;if(/\.(jpe?g|png|bmp)$/i.test(t.name)){var n=new FileReader;a.clearAllDraw(),a.clearBgAll(),n.onload=function(){a.imgTitle=t.name,s.src=this.result,a.canvasBg=this.result},n.readAsDataURL(t),i.value="",s.onload=function(){new fabric.Image(s,{zIndex:-1});e.setCanvasBg(e.canvasBg),e.isSelectDrawType=!1,e.isImage=!0}}}else this.$message.warning($t("draw.unmarkedSelectedFolder"))},handleUpImage:function(){var t=this,e=[],a=p(this.SelectFileList);a.map((function(t){/\.(jpe?g|png|bmp)$/i.test(t.name)&&e.push(t)})),this.$emit("handleGetFileImage",{list:e,type:"fileImage"});var i=l({title:"",type:""},JSON.parse(localStorage.getItem("selcetFileIndex"))),s=i.title,n=i.type;e.forEach((function(a,i){return a.name===s?e.length>=i&&"fileImage"===n?(t.loadUploadImage(e[i]),!1):(t.loadUploadImage(e[0]),!1):i===e.length-1&&a.name!==s&&"fileImage"!==n?(t.loadUploadImage(e[0]),!1):void 0}))},initClickBig:function(){At=document.getElementById("copycanvas"),Ot=At.getContext("2d"),Ot.imageSmoothingEnabled=!1},initCopyCanvas:function(){var t=this;this.canvasSource=document.getElementById("canvas"),this.copycanvas=document.getElementById("copycanvas"),this.copycontext=this.copycanvas.getContext("2d"),this.square=document.getElementById("square"),this.boxSource=this.canvasSource.getBoundingClientRect(),window.onmousemove=function(e){var a=e.clientX,i=e.clientY;a>=t.canvasSource.offsetLeft&&a<=t.canvasSource.offsetLeft+t.canvasSource.width&&i>=t.canvasSource.offsetTop&&i<=t.canvasSource.offsetTop+t.canvasSource.height?t.createSquare(a,i):(t.hideSquare(),t.hideCanvas())}},createSquare:function(t,e){var a=t-45<this.canvasSource.offsetLeft?this.canvasSource.offsetLeft:t-45,i=e-45<this.canvasSource.offsetTop?this.canvasSource.offsetTop:e-45;a=t+90<this.boxSource.right?t:this.boxSource.right-90,i=e+90<this.boxSource.bottom?e:this.boxSource.bottom-90,this.squaredata.left=t,this.squaredata.top=e,this.moveSquare(a,i)},moveSquare:function(t,e){this.square.style.left=t+"px",this.square.style.top=e+"px",this.showCanvas(),this.showSquare(),this.copy()},showCanvas:function(){this.copycanvas.style.display="inline"},copy:function(){this.copycontext.drawImage(this.canvasSource,this.squaredata.left-this.boxSource.left,this.squaredata.top-this.boxSource.top,90,90,0,0,this.copycanvas.width,this.copycanvas.height)},showSquare:function(){this.square.style.display="block"},hideSquare:function(){this.square.style.display="none"},hideCanvas:function(){this.copycanvas.style.display="none"},updateFor:function(t,e){var a=this.width,i=this.height,s=Mt.x*t,n=Mt.y*e,o=Math.floor(550*t),r=Math.floor(400*e);s+o>a&&(s=a-o),n+r>i&&(n=i-r),Ot.drawImage(Lt._originalElement,s/t,n/e,550,400,0,0,550*t,400*e),Ot.drawImage(At,0,0,o,r,0,0,550,400)},chooseTools:function(t){this.isVisibleaDrawer=!0,this.changeSelectedColorVal={},t.id&&(this.changeSelectedColorVal=t),this.isVisibleaDrawer=!0,this.changeSelectedColorVal={},t.id&&(this.changeSelectedColorVal=t)},canvasChangeAdd:function(t){this.scaleNum=2,this.canvas.setZoom(2)},canvasChangeReduce:function(t){this.scaleNum=1,this.canvas.setZoom(1)},init:function(){var t=this;this.canvas=new fabric.Canvas("canvas",{}),this.canvas.selectionColor="rgba(0,0,0,0.05)",this.canvas.defaultCursor="crosshair",this.canvas.hoverCursor="pointer",this.canvas.preserveObjectStacking=!0,this.canvas.on("mouse:down",this.mousedown),this.canvas.on("mouse:move",this.mousemove),this.canvas.on("mouse:up",this.mouseup),this.canvas.on("object:modified",this.modified),this.canvas.on("object:selected",this.objectSelected),this.canvas.on("object:scaling",this.objectScaleing),this.canvas.on("mouse:wheel",(function(e){e.e.preventDefault(),e.e.altKey&&!t.isSelectDrawType?(document.querySelector("body").setAttribute("style","overflow: hidden"),t.zoom=(e.e.deltaY>0?-.1:.1)+t.canvas.getZoom(),t.zoom=Math.max(.1,t.zoom),t.zoom=Math.min(3,t.zoom),t.zoomPoint=new fabric.Point(e.pointer.x,e.pointer.y),t.canvas.zoomToPoint(t.zoomPoint,t.zoom),t.resetOriginAfterZoom(),t.setCanvasBg(t.canvasBg)):document.querySelector("body").setAttribute("style","overflow: auto")}))},initialZoom:function(){this.zoom=.8,this.zoomPoint=new fabric.Point(this.canvas.width/2,this.canvas.height/2),this.canvas.zoomToPoint(this.zoomPoint,this.zoom),this.resetOriginAfterZoom()},resetOriginAfterZoom:function(){this.lastzoomPoint.x=this.lastzoomPoint.x+(this.zoomPoint.x-this.lastmousePoint.x-this.relativeMouseX)/this.lastzoom,this.lastzoomPoint.y=this.lastzoomPoint.y+(this.zoomPoint.y-this.lastmousePoint.y-this.relativeMouseY)/this.lastzoom,this.lastmousePoint.x=this.zoomPoint.x,this.lastmousePoint.y=this.zoomPoint.y,this.lastzoom=this.zoom,this.tempmouseX=this.relativeMouseX,this.tempmouseY=this.relativeMouseY,this.relativeMouseX=0,this.relativeMouseY=0},resizeCanvas:function(){this.canvas.width=.72*document.getElementById("draw").offsetWidth,this.canvas.height=.72*document.getElementById("draw").offsetHeight,this.canvas.setWidth(this.canvas.width),this.canvas.setHeight(this.canvas.height),this.initialZoom()},zoomToFitCanvas:function(){this.canvas.setZoom(1),this.canvas.absolutePan({x:0,y:0});var t=this.canvas.getObjects();if(t.length>0)for(var e=t[0].getBoundingRect(),a=e.left,i=e.top,s=e.left+e.width,n=e.top+e.height,o=1;o<t.length;o++)e=t[o].getBoundingRect(),a=Math.min(a,e.left),i=Math.min(i,e.top),s=Math.max(s,e.left+e.width),n=Math.max(n,e.top+e.height);var r=(s-a-canvas.width)/2+a,l=(n-i-canvas.height)/2+i;this.canvas.absolutePan({x:r,y:l}),this.zoom=Math.min(this.canvas.width/(s-a),this.canvas.height/(n-i)),this.zoomPoint=new fabric.Point(this.canvas.width/2,this.canvas.height/2),this.canvas.zoomToPoint(this.zoomPoint,this.zoom)},setCanvasBg:function(t){var e=this;fabric.Image.fromURL(t,(function(t){Lt=t.set({scaleX:e.canvas.width/t.width,scaleY:e.canvas.width/t.width}),e.CoefficientPosi=e.canvas.width/t.width,e.bgWidth=t.width,e.bgHeight=t.height,e.canvas.setBackgroundImage(t,e.canvas.renderAll.bind(e.canvas)),e.canvas.renderAll(),e.bgImgX=Lt.lineCoords.tr.x,e.bgImgY=Lt.lineCoords.br.y,e.bgImgLeftTopX=Lt.lineCoords.tl.x,e.bgImgLeftBottomY=Lt.lineCoords.bl.y}))},restoration:function(){this.canvas.setZoom(1);var t=new fabric.Point(this.width/4,this.height/4);this.canvas.relativePan(t),this.moveCanvasInfo.lastX=this.width/4,this.moveCanvasInfo.lastY=this.height/4},drawTypeChange:function(t){this.canvasBg?(this.isSelectDrawType=!1,this.drawType=t,this.preDrawType=t,this.canvas.skipTargetFind=!!t,this.canvas.isDrawingMode=!1,this.drawCanDia="rectangle"===t):(this.isSelectDrawType=!0,this.$message.warning($t("draw.selelctPictureClicking")),this.drawCanDia=!1)},transformMouse:function(t,e){return{x:t/this.zoom,y:e/this.zoom}},getX:function(t){return this.lastzoomPoint.x+(t.pointer.x-this.zoomPoint.x-this.relativeMouseX)/this.canvas.getZoom()},getY:function(t){return this.lastzoomPoint.y+(t.pointer.y-this.zoomPoint.y-this.relativeMouseY)/this.canvas.getZoom()},mousedown:function(t){var e=this.canvas.getObjects();if(t.target&&e.map((function(e){t.target.id===e.id&&(e.hasControls=!0)})),this.drawCanDia=!1,this.canvasBg){if(this.mouseFrom.x=this.getX(t),this.mouseFrom.y=this.getY(t),this.doDrawing=!0,t.e.altKey&&(this.moveCanvasInfo.lastX=t.e.clientX,this.moveCanvasInfo.lastY=t.e.clientY,this.preDrawType=this.drawType,this.drawType=null,this.moveCanvasInfo.isDragging=!0,this.isMoveScal=!0,this.setCanvasBg(this.canvasBg)),t.e.ctrlKey&&this.isCanCtrlPolygon(),"polygon"===this.drawType)try{this.pointArray.length>1&&t.target&&t.target.id===this.pointArray[0].id&&this.generatePolygon(),this.polygonMode&&this.addPoint(t)}catch(a){}}else this.drawCanDia=!1},mousemove:function(t){if(!(this.moveCount%2)||this.doDrawing){if(this.moveCount++,"polygon"!==this.drawType&&this.drawing(t),"polygon"===this.drawType){if(this.activeLine&&"line"===this.activeLine.class){var e=this.canvas.getPointer(t.e);this.activeLine.set({x2:e.x,y2:e.y});var a=this.activeShape.get("points");a[this.pointArray.length]={x:e.x,y:e.y,zIndex:1},this.activeShape.set({points:a}),this.canvas.renderAll()}this.canvas.renderAll()}if(this.moveCanvasInfo.isDragging){var i=new fabric.Point(t.e.movementX,t.e.movementY);return this.canvas.relativePan(i),this.relativeMouseX+=t.e.movementX,void(this.relativeMouseY+=t.e.movementY)}this.mouseTo.x=this.getX(t),this.mouseTo.y=this.getY(t)}},mouseup:function(t){"rectangle"===this.preDrawType&&this.isMoveScal?(this.drawType=this.preDrawType,this.isMoveScal=!1):"polygon"===this.preDrawType&&this.isMoveScal&&(this.isMoveScal=!1,this.drawType=this.preDrawType),this.mouseFrom.x=this.getX(t),this.mouseFrom.y=this.getY(t),this.drawingObject=null,this.moveCount=1,"polygon"!==this.drawType&&(this.doDrawing=!1),this.drawCanDia&&this.drawEnd(),this.moveCanvasInfo.isDragging=!1,this.moveCanvasInfo.selection=!0},drawEnd:function(){this.isVisiblea=!0,this.isEdit=!1,this.submitDraw("名称")},modified:function(t){this.$emit("listenModified",t.target)},objectScaleing:function(t){var e=t.target;!e.strokeWidthUnscaled&&e.strokeWidth&&(e.strokeWidthUnscaled=e.strokeWidth),e.strokeWidthUnscaled&&(e.strokeWidth=e.strokeWidthUnscaled/e.scaleX)},objectMoving:function(t){var e=t.pointer.x-this.bgImgX>0||t.pointer.y-this.bgImgY>0;e&&(this.$message.warning($t("draw.exceedingMarked")),this.canvas.skipTargetFind=!0,this.canvas.remove(t.target),this.$emit("deleteItem",t.target),this.canvas.renderAll())},objectSelected:function(t){},drawing:function(t){this.drawingObject&&this.canvas.remove(this.drawingObject);var e=null,a=this.mouseFrom.x,i=this.mouseFrom.y,s=this.mouseFrom,n=this.mouseTo;switch(this.drawType){case"rectangle":t.e.shiftKey&&(n.x-a>n.y-i?n.y=i+n.x-a:n.x=a+n.y-i);var o="M "+s.x+" "+s.y+" L "+n.x+" "+s.y+" L "+n.x+" "+n.y+" L "+s.x+" "+n.y+" L "+s.x+" "+s.y+" z";e=new fabric.Path(o,{left:a,top:i,stroke:this.color,strokeWidth:this.drawWidth,fill:this.fillColor,hasControls:!0,id:this.currentKey(),scaleX:1,scaleY:1,opacity:.4,objectCaching:!1,selectable:!1,type:"rectangular"});break;default:break}e&&(this.canvas.add(e),this.drawingObject=e,this.drawCanDia=!0)},drawPolygon:function(){this.canvasBg?(this.isDrawEdit&&(this.isDrawPolygon(),this.isDrawEdit=!1),this.drawType="polygon",this.preDrawType=this.drawType,this.polygonMode=!0,this.pointArray=new Array,this.lineArray=new Array,this.canvas.isDrawingMode=!1):(this.$message.warning($t("draw.selelctPictureClicking")),this.drawCanDia=!1)},drawEdit:function(){this.drawType=null,this.doDrawing=!1,this.polygonMode=!1,this.isDrawPolygon()},isDrawPolygon:function(t){var e=this;this.isDrawEdit=!this.isDrawEdit,this.canvas.getObjects().map((function(a){"polygon"!==a.type&&"rectangular"!==a.type||(a.set({selectable:!t&&e.isDrawEdit}),e.canvas.renderAll())})),this.canvas.skipTargetFind=!t&&!this.isDrawEdit},isCanCtrlPolygon:function(){var t=this;this.canvas.getObjects().map((function(e){"polygon"===e.type&&(e.set({hasControls:!t.isCanCtrlFlag}),t.canvas.renderAll())}));var e=this.canvas.getActiveObject();e.hasControls=!0,"polygon"===e.type&&this.changeDrawPolygon(e)},changeDrawPolygon:function(t){var e=this.canvas,a=e.getObjects().length,i=t||e.getObjects()[a-1];if(e.setActiveObject(i),i.edit=!i.edit,i.edit){var s=i.points.length-1;i.cornerStyle="circle",i.cornerColor="rgba(0,0,255,0.5)",i.controls=i.points.reduce((function(t,e,a){return t["p"+a]=new fabric.Control({positionHandler:It,actionHandler:St(a>0?a-1:s,Tt),actionName:"modifyPolygon",pointIndex:a}),t}),{})}else i.cornerStyle="rect",i.controls=fabric.Object.prototype.controls;i.hasBorders=!i.edit,e.requestRenderAll()},generatePolygon:function(){var t=this,e=new Array;this.pointArray.map((function(a,i){e.push({x:a.left,y:a.top}),t.canvas.remove(a)})),this.lineArray.map((function(e,a){t.canvas.remove(e)})),this.canvas.remove(this.activeShape).remove(this.activeLine);var a=new fabric.Polygon(e,{stroke:this.color,strokeWidth:this.drawWidth,fill:this.fillColor,cornerColor:"blue",objectCaching:!1,hasControls:!0,id:this.currentKey(),type:"polygon",selectable:!1});this.canvas.add(a),this.activeLine=null,this.activeShape=null,this.polygonMode=!1,this.doDrawing=!1,this.drawCanDia=!0},canEditPolygon:function(t){var e=new fabric.Polygon(t,{fill:this.fillColor,strokeWidth:this.drawWidth,stroke:this.color,objectCaching:!1,transparentCorners:!1,cornerColor:"blue",id:this.currentKey()});return e},currentKey:function(){var t=Math.floor(1e4*Math.random());return(new Date).getTime()+t},addPoint:function(t){var e=Math.floor(1e4*Math.random()),a=(new Date).getTime()+e,i=this.mouseFrom.x,s=this.mouseFrom.y,n=new fabric.Circle({radius:6,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,left:i,top:s,selectable:!1,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",id:a,objectCaching:!1});0===this.pointArray.length&&(n.set({fill:"red"}),this.canvas.skipTargetFind=!1);var o=[i,s,i,s];if(this.line=new fabric.Line(o,{strokeWidth:2,fill:"#999999",stroke:"#999999",class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1}),this.activeShape){var r=this.canvas.getPointer(t.e);o=this.activeShape.get("points");o.push({x:r.x,y:r.y});var l=new fabric.Polygon(o,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.4,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});this.canvas.remove(this.activeShape),this.canvas.add(l),this.activeShape=l,this.canvas.renderAll()}else{var c=[{x:i,y:s}];l=new fabric.Polygon(c,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.4,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});this.activeShape=l,this.canvas.add(l)}this.activeLine=this.line,this.pointArray.push(n),this.lineArray.push(this.line),this.canvas.add(this.line),this.canvas.add(n)},deleteObj:function(){var t=this;this.canvas.getActiveObjects().map((function(e){t.canvas.remove(e),t.$emit("deleteItem",e)}))},keyboardMove:function(t,e){var a=this;this.canvas.getObjects().map((function(i){t.id===i.id&&("top"===e?(i.set({top:t.top-1}),a.$emit("listenobjectMoved",t.id,"top",t.top-1)):"bottom"===e?(i.set({top:t.top+1}),a.$emit("listenobjectMoved",t.id,"top",t.top+1)):"left"===e?(i.set({left:t.left-1}),a.$emit("listenobjectMoved",t.id,"left",t.left-1)):(i.set({left:t.left+1}),a.$emit("listenobjectMoved",t.id,"left",t.left+1)),a.canvas.renderAll())}))},keyboardFn:function(){var t=this;document.onkeydown=function(e){var a;46===e.keyCode&&t.deleteObj(),90===e.keyCode&&e.ctrlKey&&"polygon"===t.drawType&&t.pointArray.length>=1&&t.backoutDraw(),13===e.keyCode&&"polygon"===t.drawType&&t.pointArray.length>1&&(t.generatePolygon(),t.drawEnd()),38===e.keyCode?(e.preventDefault(),a=t.canvas.getActiveObject(),t.keyboardMove(a,"top")):40===e.keyCode?(e.preventDefault(),a=t.canvas.getActiveObject(),t.keyboardMove(a,"bottom")):37==e.keyCode?(e.preventDefault(),a=t.canvas.getActiveObject(),t.keyboardMove(a,"left")):39===e.keyCode&&(e.preventDefault(),a=t.canvas.getActiveObject(),t.keyboardMove(a,"right"))}},backoutDraw:function(){this.canvas.remove(this.pointArray[this.pointArray.length-1]),this.canvas.remove(this.lineArray[this.lineArray.length-1]),this.canvas.remove(this.lineArray[this.lineArray.length-2]),this.pointArray.pop(),this.lineArray.pop();var t=this.activeShape.get("points");t.pop(),this.activeShape.set({points:t}),this.canvas.renderAll()},submitDraw:function(t){if(this.isImage=!1,this.canvas.getObjects().length)if(this.isImage=!0,"sub"!==t){var e=this.canvas.toDatalessJSON().objects[this.canvas.toDatalessJSON().objects.length-1],a=this.canvas.getObjects()[this.canvas.getObjects().length-1];switch(e.type){case"rectangular":this.$emit("desclistFn",this.desclistObj(e,t,a));break;case"polygon":this.$emit("desclistFn",this.desclistObj(e,t,a)),this.drawPolygon();break;default:break}}else{var i={currentProId:this.currentProId,curentDataSetId:this.curentDataSetId,currentImgId:this.currentImgId,imgUrl:this.canvasBg},s=localStorage.getItem("alreadyTag")?JSON.parse(localStorage.getItem("alreadyTag")):[];this.SelectFile.name?(s.indexOf(this.SelectFile.webkitRelativePath)<0&&(s.push(this.SelectFile.webkitRelativePath),s=JSON.stringify(s),localStorage.setItem("alreadyTag",s)),this.isImage=!0,this.$emit("subApi",{DataObj:l({},i),ImgTitle:this.imgTitle})):(this.isImage=!1,this.$emit("subApi",{DataObj:l({},i),ImgTitle:this.imgTitle}))}else{this.isImage=!1;var n={currentProId:this.currentProId,curentDataSetId:this.curentDataSetId,currentImgId:this.currentImgId,imgUrl:this.canvasBg},o=localStorage.getItem("alreadyTag")?JSON.parse(localStorage.getItem("alreadyTag")):[];this.SelectFile.name?o.indexOf(this.SelectFile.webkitRelativePath)<0&&(this.isImage=!1,o.push(this.SelectFile.webkitRelativePath),o=JSON.stringify(o),localStorage.setItem("alreadyTag",o),this.$emit("subApi",{DataObj:l({},n),ImgTitle:this.imgTitle})):(this.isImage=!1,this.$emit("subApi",{DataObj:l({},n),ImgTitle:this.imgTitle}))}},desclistObj:function(t,e,a){var i={angle:t.angle||0,height:t.height||0,width:t.width||0,left:t.left||0,top:t.top||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1,strokeWidth:t.strokeWidth||1,stroke:t.stroke||"",fill:t.fill||"rgba(255, 255, 255, 0)",descibe:e,type:t.type,id:a.id,hidden:!1,opacity:t.opacity};return t.type&&"rectangular"!==t.type?i.path=t.points:i.path=t.path,i},descibeFn:function(t){this.submitDraw(t)},widthChange:function(){document.body.offsetWidth>1700?(this.paddingLft="0px",this.marTop="60px",this.outWidth=1250):(this.paddingLft="0px",this.marTop="10px",this.outWidth=765)},bgChangeFn:function(t){var e=this;if(""!==this.fromCenterVal&&"refuse"!==this.fromCenterVal||!this.canvas.getObjects().length){if(this.currentImgId=t.id,this.curentDataSetId=t.dataSetId,this.canvasBg=t.pictureUrl,this.setCanvasBg(this.canvasBg),""!==this.fromCenterVal&&"refuse"!==this.fromCenterVal){var a=[];a="check"===this.fromCenterVal?t.baaitagTags.filter((function(t){return"1"===t.completeType&&"0"===t.checkType&&"0"===t.inspectType})):t.baaitagTags.filter((function(t){return"1"===t.completeType&&"1"===t.checkType&&"1"===t.inspectType})),this.inspectTimes=a[0].inspectTimes?a[0].inspectTimes:"1",this.inspectTagId=a[0].id?a[0].id:"",this.clearAllDraw();var i=JSON.parse(a[0].tagContent).desiList;i.forEach((function(t){"polygon"===t.type?e.showPolygon(t):e.showRectangle(t)})),this.$emit("allDesiListFn",i)}}else this.$message.warning($t("draw.submitSwitching"))},clearAllDraw:function(){var t=this;this.canvas.getObjects().map((function(e){t.canvas.remove(e)})),this.doDrawing=!1,this.$emit("clearDesFn",[]),this.pointArray.length>0&&(this.lineArray=[],this.pointArray=[],this.activeLine=null,this.activeShape=null)},clearBgAll:function(){this.canvas.clear()},rectanglePath:function(t){var e;return(e=[]).concat.apply(e,p(t)).join(" ")},showRectangle:function(t){var e=new fabric.Path(this.rectanglePath(t.path),{angle:t.angle||0,height:t.height||0,width:t.width||0,left:t.left||0,top:t.top||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1,strokeWidth:t.strokeWidth||2,stroke:t.stroke||"",fill:t.fill||"rgba(255, 255, 255, 0)",hasControls:!1,id:t.id,opacity:1});this.canvas.add(e),this.canvas.skipTargetFind=!1,this.canvas.perPixelTargetFind=!1},showPolygon:function(t){this.canvas.add(this.polygonObg(t))},polygonObg:function(t){var e=new fabric.Polygon(t.path,Object.assign(t,{angle:t.angle||0,height:t.height||0,width:t.width||0,left:t.left||0,top:t.top||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1,strokeWidth:t.strokeWidth||2,stroke:t.stroke||"",fill:t.fill||"rgba(255, 255, 255, 0)",hasControls:!1,id:t.id}));return e},hiddenDraw:function(t,e){var a=this;if(t.type&&"rectangular"!==t.type?this.polygonObg(t):new fabric.Path(this.rectanglePath(t.path),Object.assign(t,{angle:t.angle||0,height:t.height,width:t.width,left:t.left||0,top:t.top||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1,strokeWidth:t.strokeWidth||2,stroke:t.stroke,fill:"rgba(255, 255, 255, 0.4)",hasControls:!0,id:t.id,opacity:1,selectable:t.selectable})),e){!t.type||t.type;this.canvas.getObjects().forEach((function(e){e.id===t.id&&a.canvas.remove(e)}))}},highLightdata:function(t,e){var a=this;this.canvas.getObjects().map((function(e){t.id===e.id&&(e.set({opacity:1}),a.canvas.renderAll())}))},reducehighLightdata:function(t,e){var a=this;this.canvas.getObjects().map((function(e){t.id===e.id&&(e.set({opacity:.4}),a.canvas.renderAll())}))},confirmClear:function(){this.clearAllDraw()},chanageSelectedColor:function(t){var e=this;this.canvas.getObjects().map((function(a){t.id===a.id&&(a.set({stroke:t.stroke,fill:t.fill}),e.canvas.renderAll(),e.$emit("listenColorChnange",t))}))}},components:{ImgList:C,TagDescribe:A,DrawerTool:bt,rectangleSvg:Pt.a,polygonSvg:Et.a,ADrawer:kt}}),Ft=Bt,Rt=(a("e786"),Object(x["a"])(Ft,m,g,!1,null,"e473303a",null)),zt=Rt.exports,Vt={props:{},inject:["reload"],data:function(){return{desiList:[],fileList:[],ids:{},tagContent:{},queryProId:"",dropMenu:[{index:0,name:"颜色和名称"}],fileType:"",index:0,selectItem:"",fileAttribute:"file",tabsKey:"1",alreadyTag:[]}},beforeRouteEnter:function(t,e,a){a((function(e){t.query.id&&""!==e.fromCenterVal?(e.queryProId=t.query.id,a()):a(t.path)}))},beforeRouteLeave:function(t,e,a){this.$store.commit(pt["f"],""),this.desiList=[],a()},computed:{fromCenterVal:function(){return this.$store.state.labels.fromCenterVal}},methods:{desclistFn:function(t){this.index=this.index+1;var e=t;e.descibe=e.descibe+this.index,this.desiList.push(e)},listenModified:function(t){this.desiList.map((function(e){e.id===t.id&&(e.angle=t.angle||0,e.height=t.height||0,e.width=t.width||0,e.left=t.left||0,e.top=t.top||0,e.scaleX=t.scaleX||1,e.scaleY=t.scaleY||1,e.path=t.path||t.points,e.strokeWidth=t.strokeWidth)}))},allDesiListFn:function(t){this.desiList=t},handleGetFile:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.list,a=void 0===e?[]:e,i=t.type,s=void 0===i?"":i;this.fileList=p(a);var n=l({title:"",type:""},JSON.parse(localStorage.getItem("selcetFileIndex"))),o=n.title,r=n.type;return r===s?(this.selectItem=o,!1):(this.selectItem=this.fileList[0].name,!1)},handleGetFileImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.list,a=void 0===e?[]:e,i=t.type,s=void 0===i?"":i;this.fileList=[],this.fileList=p(a);var n=l({title:"",type:""},JSON.parse(localStorage.getItem("selcetFileIndex"))),o=n.title,r=n.type;return r===s?(this.selectItem=o,!1):(this.selectItem=this.fileList[0].name,!1)},clearDesFn:function(t){this.desiList=t},subApi:function(t){var e=t.DataObj,a=t.ImgTitle;this.ids=l({},e),this.fileType=a.replace(/\.(jpe?g|png|gif)$/,""),this.tagContent.desiList=this.desiList,this.tagContent.imgUrl=e.imgUrl,"refuse"===this.fromCenterVal?this.againgTag(this.tagContent,this.tagContent.currentImgId):this.handleJSON(this.tagContent)},handleJSON:function(t){var e="";if(this.fileType){var a=this.fileType.indexOf(".json"),i=this.fileType.indexOf(".JSON");e=a>=0||i>=0?this.fileType:this.fileType+localStorage.getItem("i18n")==1?"_标注数据.json":"_ Annotation data.json"}else e=1==localStorage.getItem("i18n")?"标注数据.json":"Annotation data.json";var s=null;s=JSON.stringify(t,null,4),this.saveJSON(s,e)},saveJSON:function(t,e){if(t){e||(e="json.json"),"object"===Object(n["a"])(t)&&(t=JSON.stringify(t,void 0,4));var a=new Blob([t],{type:"text/json"}),i=document.createElement("a");i.download=e,i.href=window.URL.createObjectURL(a),i.dataset.downloadurl=["text/json",i.download,i.href].join(":");var s=new MouseEvent("click",{});i.dispatchEvent(s)}else alert("保存的数据为空")},handleSaveFile:function(t){},handleDesi:function(t){var e=l({},t);e.hidden=!t.hidden,this.desiList.map((function(a){a.id===t.id&&(a.hidden=e.hidden)})),t.hidden?this.$refs.childDraw.highLightdata(e,!0):this.$refs.childDraw.reducehighLightdata(e)},handleSwitch:function(t){this.fileList=[],this.tabsKey=t.selectTabs,this.fileAttribute=t.fileAttribute},handleSelectFile:function(t,e){var a={title:t.name,type:t.name.indexOf(".json")<0?"fileImage":"file"};localStorage.setItem("selcetFileIndex",JSON.stringify(a));var i=this.alreadyTag.indexOf(t.webkitRelativePath)>=0;i&&this.$message.warning($t("tag.tag10")),this.selectItem=t.name,"file"===this.fileAttribute?this.$refs["childDraw"].loadEchoImage(t):this.$refs["childDraw"].loadUploadImage(t)},deleteItem:function(t){this.desiList=this.desiList.filter((function(e){return e.id!==t.id}))},handleMenuClick:function(t,e){0===e.index&&this.$refs.childDraw.chooseTools(t)},listenColorChnange:function(t){this.desiList.map((function(e){e.id===t.id&&(e.fill=t.fill,e.stroke=t.stroke)}))},listenTagNameChnange:function(t){this.desiList.map((function(e){e.id===t.id&&(e.descibe=t.descibe)}))},listenobjectMoved:function(t,e,a){"top"===e?this.desiList.map((function(e){e.id===t&&(e.top=a)})):this.desiList.map((function(e){e.id===t&&(e.left=a)}))}},components:{Draw:zt},mounted:function(){this.handleSaveFile();var t=localStorage.getItem("alreadyTag")||[];this.alreadyTag=t.length>0?JSON.parse(t):[];var e=document.getElementById("tagBox");e.oncontextmenu=new Function("event.returnValue=false"),e.onselectstart=new Function("event.returnValue=false")}},Ut=Vt,Nt=(a("ce32"),Object(x["a"])(Ut,i,s,!1,null,"18c3bad2",null));e["default"]=Nt.exports},"13a3":function(t,e,a){},"27b8":function(t,e,a){},2875:function(t,e,a){var i=a("b2b7");t.exports={__esModule:!0,default:i.svgComponent({tag:"svg",attrsMap:{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"50px",height:"50px",viewBox:"0 0 40 40","enable-background":"new 0 0 40 40","xml:space":"preserve"},children:[{tag:"image",attrsMap:{id:"image0",width:"40",height:"40",x:"0",y:"0","xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAALGPC/xhBQAAACBjSFJN\r\nAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAh1BMVEX09Pvsr2/nhBjrpl7r\r\no1jmewfsq2ny5dzqoFHtuIHrqWPnhyDmfQvmfw/ngRLngxbnhRvnhx/oiSPoiyfojSroji7okDLp\r\nkjbplTvplz7ssHLvxp/vxZvuwJPoiCLtt4Hw1r7ssHHoiiXqmUTqmkXqmkbqm0foiibtuYPsrWzr\r\nqmbttHv///+vEPxUAAAAAWJLR0Qsut1xqwAAAAd0SU1FB+UDAQQlFxlowNgAAACcSURBVEjH7ZTL\r\nDoJADEURrDjgAxBfKIKIjsr//59l2ZHcuDGZ6Jzlac6ii9bzHA7bGfmBqcY0CUExJSIllWIVgSTm\r\nOc3mi2WSZqt8vdnu9hmbGCQFzw9SHVkVaJfyVBmmPjcl3v/ykfpC0v5QcrU1uf1PovTdMPUjVah4\r\nDp8YOuSE57oV6P62QdK/i06q6l1JBp5S4EfoKTkcVvACMkMLcRTn/qcAAAAldEVYdGRhdGU6Y3Jl\r\nYXRlADIwMjEtMDMtMDFUMDQ6Mzc6MjMrMDM6MDDMdbDqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIx\r\nLTAzLTAxVDA0OjM3OjIzKzAzOjAwvSgIVgAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFk\r\neXHJZTwAAAAASUVORK5CYII="}}]})}},4716:function(t,e,a){"use strict";var i=a("8549"),s=a.n(i);s.a},"53ca":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function i(t){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}},"5d3d":function(t,e,a){var i=a("b2b7");t.exports={__esModule:!0,default:i.svgComponent({tag:"svg",attrsMap:{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"40px",height:"40px",viewBox:"0 0 40 40","enable-background":"new 0 0 40 40","xml:space":"preserve"},children:[{tag:"image",attrsMap:{id:"image0",width:"40",height:"40",x:"0",y:"0","xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAABGdBTUEAALGPC/xhBQAAACBjSFJN\r\nAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA+VBMVEX09PvoiCLnghXrolb0\r\n8PPz7vDwzq7tt4HmfxDmewfoji3ssHLrp2Dsrm7ssnbnhRvtt4DrpVvttXzqn1DojCnts3nw1b3q\r\nnUzplz/ttn7z7/Dsr2/z7/Hz6+nz6+r08fXro1fojSvz7Oz08vfrpVzy49rmfAnrqGLrpl3uxJrx\r\n2MLpl0DojCjz6+jx3Mrx2cXpkjXpkjb08PLuvIrsrWzmfg7y4dXz7u/ojSrqoFHvza3vzKvqoVTo\r\niiXz6OLy5t/nhh7ssHHuvYzmfQzw07jplz7okDHss3fx3c3nhx/pkzj09Prw0rb08/npmEHngxfq\r\noFLokDL///8Gr779AAAAAWJLR0RSDWAtkAAAAAd0SU1FB+UDAQQnMflTJ6cAAAD7SURBVEjH7dRJ\r\nTwJBEIbhomEYvkEWUURQQURA3FA2BVdkcWPR//9nnMtIapqkUx48zXur6jzJJJNuoqCg/yqkVDhi\r\neUXd0TaRGODEN7wSCkiaCIBUOum16Y4ZE9lytrOraSe3i7yJFPby+we/U7FkHZaPDKRy7PuQaq1u\r\nINZJ1rdp4FRK6Oz8QkoukZASstGUksLVdUtIqIm2lFCn25OSm9u+lNAAd1JC9w+PUvL0PJQSehmN\r\npcSaTCtC4v4cW0roFW9r99p9WdV6//hct+e3kjdDg+b6mt99X4tl7kvf8heGl/52T3XC3zFe3AFi\r\nOuGvJS8SVipEQUF/6QcC9RiSzdIsvQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wMy0wMVQwNDoz\r\nOTo0OSswMzowMLCj1pAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDMtMDFUMDQ6Mzk6NDkrMDM6\r\nMDDB/m4sAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg=="}}]})}},7268:function(t,e,a){"use strict";var i=a("27b8"),s=a.n(i);s.a},8074:function(t,e,a){"use strict";var i=a("13a3"),s=a.n(i);s.a},"82c1":function(t,e,a){},8549:function(t,e,a){},"8a06":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"container-box"},[a("a-card",[a("template",{slot:"title"},[a("div",{staticClass:"card-header"},[a("span",[t._v(t._s(t.$t("textLabel.textLabel1")))]),a("div",{staticStyle:{display:"flex"}},[a("a-upload",{staticStyle:{"margin-right":"10px"},attrs:{beforeUpload:t.beforeUpload,name:"file",showUploadList:!1}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),t._v(" "+t._s(t.$t("textLabel.textLabel2"))+" ")],1)],1),a("a-button",{attrs:{type:"primary"},on:{click:t.exportMarked}},[t._v(t._s(t.$t("textLabel.textLabel3")))])],1)])]),a("div",{staticClass:"box-card"},t._l(t.dataList,(function(e,i){return a("a-card",{key:i,staticStyle:{"margin-bottom":"30px"}},[a("div",{staticClass:"title"},[t._v(t._s(t.$t("textLabel.textLabel18")))]),a("div",{directives:[{name:"right-click",rawName:"v-right-click:[{itemData}]",value:t.rightMenuObj,expression:"rightMenuObj",arg:{itemData:e}}],staticClass:"text",attrs:{id:i.toString()},domProps:{innerHTML:t._s(e.corpus)},on:{mousedown:t.handlemousedownSelect}}),t._l(e.markInfo,(function(e,s){return a("div",{key:s,staticClass:"edit",style:{border:1==e.status?"1px solid grey":"0",padding:"5px 8px","border-radius":"15px"}},[a("div",{staticClass:"mark-edit"},[a("div",{staticClass:"mark-edit-label"},[t._v(t._s(t.$t("textLabel.textLabel4")))]),a("div",{staticClass:"mark-edit-text"},[t._v(t._s(e.t1))])]),a("div",{staticClass:"mark-edit",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"mark-edit-label"},[t._v(t._s(t.$t("textLabel.textLabel5")))]),a("div",{staticClass:"mark-edit-text"},[t._v(t._s(e.t2))])]),a("div",{staticClass:"mark-edit",staticStyle:{"margin-left":"10px"}},[a("div",{staticClass:"mark-edit-label"},[t._v(t._s(t.$t("textLabel.textLabel6")))]),a("div",{staticClass:"mark-edit-text"},[t._v(t._s(e.aspect_term))])]),a("div",{staticClass:"attribute-label"},[a("div",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.$t("textLabel.textLabel7")))]),t._v(" "),a("a-input",{staticStyle:{flex:"1","margin-left":"10px",width:"200px"},attrs:{placeholder:"请填写标签"},model:{value:e.aspect,callback:function(a){t.$set(e,"aspect",a)},expression:"mark.aspect"}})],1),a("div",{staticClass:"comparative-view"},[a("div",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.$t("textLabel.textLabel8")))]),a("a-select",{staticStyle:{flex:"1",width:"200px","margin-left":"10px"},attrs:{placeholder:t.$t("textLabel.textLabel17"),labelInValue:!0},on:{change:function(e){return t.$forceUpdate()}},model:{value:e.option,callback:function(a){t.$set(e,"option",a)},expression:"mark.option"}},t._l(t.comparativeViewOptions,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.label))])})),1)],1),a("div",[a("a-button",{staticStyle:{"margin-left":"40px"},attrs:{type:"danger",round:"",shape:"round"},on:{click:function(e){return t.deleteMark(i,s)}}},[t._v(t._s(t.$t("textLabel.textLabel9")))]),0==e.status?a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",round:"",shape:"round"},on:{click:function(e){return t.updateMarkItem(i,s)}}},[t._v(t._s(t.$t("textLabel.textLabel10")))]):t._e(),1==e.status?a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",round:"",shape:"round"},on:{click:function(e){return t.submitMarkItem(i,s)}}},[t._v(t._s(t.$t("textLabel.textLabel11")))]):t._e()],1)])})),e.markInfo&&e.markInfo.length>0?a("div",{staticClass:"operation"},[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"danger",shape:"round"},on:{click:function(e){return t.deleteAllMark(i)}}},[t._v(t._s(t.$t("textLabel.textLabel12")))])],1):t._e()],2)})),1)],2)],1),a("a-modal",{attrs:{title:t.$t("textLabel.textLabel14"),visible:t.dialogVisibleExport},on:{ok:t.exportMarked,cancel:function(e){t.dialogVisibleExport=!1}}},[a("a-form-item",{attrs:{label:t.$t("textLabel.textLabel15")}},[a("a-date-picker",{attrs:{type:"date",placeholder:t.$t("textLabel.textLabel16"),"value-format":"YYYY-MM-DD"},model:{value:t.exportData.startDate,callback:function(e){t.$set(t.exportData,"startDate",e)},expression:"exportData.startDate"}})],1),a("div",{staticStyle:{display:"flex","align-items":"center",color:"#ccc","font-size":"13px"}},[a("a-icon",{attrs:{type:"info-circle"}}),t._v(t._s(t.$t("textLabel.textLabel13"))+" ")],1)],1)],1)},s=[],n=(a("99af"),a("4de4"),a("c740"),a("4160"),a("a15b"),a("baa5"),a("d81d"),a("ace4"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("3ca3"),a("466d"),a("5319"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("159b"),a("ddb0"),a("2b3d"),a("53ca"));a("96cf"),a("e6cf");function o(t,e,a,i,s,n,o){try{var r=t[n](o),l=r.value}catch(c){return void a(c)}r.done?e(l):Promise.resolve(l).then(i,s)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var n=t.apply(e,a);function r(t){o(n,i,s,r,l,"next",t)}function l(t){o(n,i,s,r,l,"throw",t)}r(void 0)}))}}a("c975");function l(t){return null===t||void 0===t||""===t}var c={name:"Mark",data:function(){return{dataList:[],dialogVisibleExport:!1,pagination:{total:0},exportData:{startDate:""},comparativeViewOptions:[{value:"SAME",label:"SAME"},{value:"BETTER",label:"BETTER"},{value:"WORSE",label:"WORSE"}]}},beforeCreate:function(){FileReader.prototype.reading=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pms,e=t.encode,a=new Uint8Array(this.result),i=new TextDecoder(e||"UTF-8").decode(a);return i},FileReader.prototype.readAsBinaryString=function(t){var e=this;this.onload||(this.onload=function(t){e.reading()}),this.readAsArrayBuffer(t)}},methods:{submit:function(t,e){return r(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,MarkService.submit({corpusID:t,markInfo:e});case 2:i=a.sent,0==i.code&&(MessageService.showSuccess("提交成功"),query());case 4:case"end":return a.stop()}}),a)})))()},deleteMark:function(t,e){var a=this.dataList[t].markInfo[e].index;try{for(var i=new RegExp('(?<=(<span index="'.concat(a,'")).*?(?=(</span>))'),"g"),s=this.dataList[t].corpus.match(i),n=0;n<s.length;n++)this.dataList[t].corpus=this.dataList[t].corpus.replace('<span index="'.concat(a,'"').concat(s[n],"</span>"),s[n].substring(s[n].lastIndexOf(';">')+3,s[n].length))}catch(o){}this.dataList[t].markInfo=this.dataList[t].markInfo.filter((function(t,a){return a!=e})),this.$forceUpdate()},deleteAllMark:function(t){var e=this;this.dataList[t].markInfo.forEach((function(a,i){for(var s=new RegExp('(?<=(<span index="'.concat(i,'")).*?(?=(</span>))'),"g"),n=e.dataList[t].corpus.match(s),o=0;o<n.length;o++)e.dataList[t].corpus=e.dataList[t].corpus.replace('<span index="'.concat(i,'"').concat(n[o],"</span>"),n[o].substring(n[o].lastIndexOf(';">')+3,n[o].length))})),this.dataList[t].markInfo=null,this.$forceUpdate()},download:function(t,e){var a=document.createElement("a");a.download=e,a.rel="noopener",a.href=t,a.dispatchEvent(new MouseEvent("click"))},exportMarked:function(){var t=this.deepClone(this.dataList),e=t.map((function(t){return t.corpus=t.corpus1,delete t.corpus1,t})).filter((function(t){return!l(t.markInfo)}));if(0==e.length)this.$message.warning("暂无数据可导出！");else{var a=JSON.stringify(e,null,4),i="data:,".concat(a);this.download(i,"已标注数据.json"),this.saveAsJson(a,"已标注数据.json")}},deepClone:function(t){var e=JSON.stringify(t),a=JSON.parse(e);return a},saveAsJson:function(t,e){var a=new Blob([t],{type:"application/json;charset=utf-8"}),i=URL.createObjectURL(a),s=document.createElement("a");s.style.display="none",s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},saveJSON:function(t,e){if(t){e||(e="json.json"),"object"===Object(n["a"])(t)&&(t=JSON.stringify(t,void 0,4));var a=new Blob([t],{type:"text/json"}),i=document.createElement("a");i.download=e,i.href=window.URL.createObjectURL(a),i.dataset.downloadurl=["text/json",i.download,i.href].join(":");var s=new MouseEvent("click",{});i.dispatchEvent(s)}else alert("保存的数据为空")},updateMarkItem:function(t,e){this.dataList[t].markInfo=this.dataList[t].markInfo.map((function(t){return t.status=0,t})),this.dataList[t].markInfo[e].status=1,this.$forceUpdate()},submitMarkItem:function(t,e){this.dataList[t].markInfo=this.dataList[t].markInfo.map((function(t){return t.status=0,t})),this.dataList[t].markInfo[e].status=0,this.$forceUpdate()},handlemousedownSelect:function(t){2==t.button&&t.preventDefault()},beforeUpload:function(t){return this.fileList=[t],this.read(t),!1},read:function(t){var e=this,a=new FileReader;a.onload=function(t){var i=a.reading({encode:"GBK"});e.dataList=i.split("\r\n").map((function(t,e){return{corpus:t,corpus1:t,index:e}}))},a.readAsBinaryString(t)}},computed:{rightMenuObj:function(){var t=this,e=localStorage.getItem("i18n");return{this:this,text:[1==e?"主体":"Body",1==e?"客体":"Object",1==e?"属性":"Properties"],handler:{subjectFun:function(e){var a,i=!1,s=!1;if(t.dataList[e.index].markInfo&&t.dataList[e.index].markInfo.forEach((function(t){var a=t.t1_start,n=t.t1_end,o=t.t2_start,r=t.t2_end,l=t.aspect_term_start,c=t.aspect_term_end;e.text.anchorOffse>a&&e.text.anchorOffse<n&&(i=!0),e.text.focusOffset>a&&e.text.focusOffset<n&&(i=!0),e.text.anchorOffse>o&&e.text.anchorOffse<r&&(i=!0),e.text.focusOffset>o&&e.text.focusOffset<r&&(i=!0),e.text.anchorOffse>l&&e.text.anchorOffse<c&&(i=!0),e.text.focusOffset>l&&e.text.focusOffset<c&&(i=!0),e.text.anchorOffse==a&&e.text.focusOffset==n&&(s=!0),e.text.anchorOffse==o&&e.text.focusOffset==r&&(s=!0),e.text.anchorOffse==l&&e.text.focusOffset==c&&(s=!0)})),!i||s){if(null==t.dataList[e.index].markInfo||""==t.dataList[e.index].markInfo||0==(null===(a=t.dataList[e.index].markInfo)||void 0===a?void 0:a.length))t.dataList[e.index].markInfo=[{t1:e.text.text,t1_start:e.text.anchorOffse,t1_end:e.text.focusOffset,t2:"",t2_start:"",t2_end:"",aspect_term:"",aspect_term_start:"",aspect_term_end:"",aspect:"",opinion:void 0,status:1}];else{var n=t.dataList[e.index].markInfo.findIndex((function(t){return 1==t.status}));if(-1!=n){var o=!1;if(l(t.dataList[e.index].markInfo[n].t2_start)||l(t.dataList[e.index].markInfo[n].t2_end)||l(t.dataList[e.index].markInfo[n].aspect_term_start)||l(t.dataList[e.index].markInfo[n].aspect_term_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,s=a.t1_end,r=a.t2_start,l=a.t2_end,c=a.aspect_term_start,d=a.aspect_term_end;e.text.anchorOffse==i&&e.text.focusOffset==s&&t.dataList[e.index].markInfo[n].t2_start==r&&t.dataList[e.index].markInfo[n].t2_end==l&&t.dataList[e.index].markInfo[n].aspect_term_start==c&&t.dataList[e.index].markInfo[n].aspect_term_end==d&&(o=!0)})),o)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[n].t1=e.text.text,t.dataList[e.index].markInfo[n].t1_start=e.text.anchorOffse,t.dataList[e.index].markInfo[n].t1_end=e.text.focusOffset}else{var r,c,d,h,f=t.dataList[e.index].markInfo.length,u=!1;if(l(null===(r=t.dataList[e.index].markInfo[f])||void 0===r?void 0:r.t2_start)||l(null===(c=t.dataList[e.index].markInfo[f])||void 0===c?void 0:c.t2_end)||l(null===(d=t.dataList[e.index].markInfo[f])||void 0===d?void 0:d.aspect_term_start)||l(null===(h=t.dataList[e.index].markInfo[f])||void 0===h?void 0:h.aspect_term_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,s=a.t1_end,n=a.t2_start,o=a.t2_end,r=a.aspect_term_start,l=a.aspect_term_end;e.text.anchorOffse==i&&e.text.focusOffset==s&&t.dataList[e.index].markInfo[f].t2_start==n&&t.dataList[e.index].markInfo[f].t2_end==o&&t.dataList[e.index].markInfo[f].aspect_term_start==r&&t.dataList[e.index].markInfo[f].aspect_term_end==l&&(u=!0)})),u)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[f]={t1:e.text.text,t1_start:e.text.anchorOffse,t1_end:e.text.focusOffset,t2:"",t2_start:"",t2_end:"",aspect_term:"",aspect_term_start:"",aspect_term_end:"",aspect:"",opinion:void 0,status:1}}}for(var p=t.dataList[e.index].corpus1.split(""),m=0;m<t.dataList[e.index].markInfo.length;m++){var g=t.dataList[e.index].markInfo[m].t1_start,v=t.dataList[e.index].markInfo[m].t1_end;g===v-1?p[g]='<span index="'.concat(m,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[g],"</span>"):(p[g]='<span index="'.concat(m,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[g]),p[v-1]="".concat(t.dataList[e.index].corpus1[v-1],"</span>"));var b=t.dataList[e.index].markInfo[m].t2_start,w=t.dataList[e.index].markInfo[m].t2_end;b===w-1?p[b]='<span index="'.concat(m,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[b],"</span>"):(p[b]='<span index="'.concat(m,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[b]),p[w-1]="".concat(t.dataList[e.index].corpus1[w-1],"</span>"));var y=t.dataList[e.index].markInfo[m].aspect_term_start,x=t.dataList[e.index].markInfo[m].aspect_term_end;y===x-1?p[y]='<span index="'.concat(m,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[y],"</span>"):(p[y]='<span index="'.concat(m,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[y]),p[x-1]="".concat(t.dataList[e.index].corpus1[x-1],"</span>")),t.dataList[e.index].markInfo[m].index=m}t.dataList[e.index].corpus=p.join("")}else MessageService.showWarning("选定数据存在重复")},objectFun:function(e){var a=!1,i=!1;if(t.dataList[e.index].markInfo&&t.dataList[e.index].markInfo.forEach((function(t){var s=t.t1_start,n=t.t1_end,o=t.t2_start,r=t.t2_end,l=t.aspect_term_start,c=t.aspect_term_end;e.text.anchorOffse>s&&e.text.anchorOffse<n&&(a=!0),e.text.focusOffset>s&&e.text.focusOffset<n&&(a=!0),e.text.anchorOffse>o&&e.text.anchorOffse<r&&(a=!0),e.text.focusOffset>o&&e.text.focusOffset<r&&(a=!0),e.text.anchorOffse>l&&e.text.anchorOffse<c&&(a=!0),e.text.focusOffset>l&&e.text.focusOffset<c&&(a=!0),e.text.anchorOffse==s&&e.text.focusOffset==n&&(i=!0),e.text.anchorOffse==o&&e.text.focusOffset==r&&(i=!0),e.text.anchorOffse==l&&e.text.focusOffset==c&&(i=!0)})),!a||i){if(null==t.dataList[e.index].markInfo||""==t.dataList[e.index].markInfo)t.dataList[e.index].markInfo=[{t1:"",t1_start:"",t1_end:"",t2:e.text.text,t2_start:e.text.anchorOffse,t2_end:e.text.focusOffset,aspect_term:"",aspect_term_start:"",aspect_term_end:"",aspect:"",opinion:"",status:1}];else{var s=t.dataList[e.index].markInfo.findIndex((function(t){return 1==t.status}));if(-1!=s){var n=!1;if(l(t.dataList[e.index].markInfo[s].t1_start)||l(t.dataList[e.index].markInfo[s].t1_end)||l(t.dataList[e.index].markInfo[s].aspect_term_start)||l(t.dataList[e.index].markInfo[s].aspect_term_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,o=a.t1_end,r=a.t2_start,l=a.t2_end,c=a.aspect_term_start,d=a.aspect_term_end;e.text.anchorOffse==r&&e.text.focusOffset==l&&t.dataList[e.index].markInfo[s].t1_start==i&&t.dataList[e.index].markInfo[s].t1_end==o&&t.dataList[e.index].markInfo[s].aspect_term_start==c&&t.dataList[e.index].markInfo[s].aspect_term_end==d&&(n=!0)})),n)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[s].t2=e.text.text,t.dataList[e.index].markInfo[s].t2_start=e.text.anchorOffse,t.dataList[e.index].markInfo[s].t2_end=e.text.focusOffset}else{var o,r,c,d,h=t.dataList[e.index].markInfo.length,f=!1;if(l(null===(o=t.dataList[e.index].markInfo[h])||void 0===o?void 0:o.t1_start)||l(null===(r=t.dataList[e.index].markInfo[h])||void 0===r?void 0:r.t1_end)||l(null===(c=t.dataList[e.index].markInfo[h])||void 0===c?void 0:c.aspect_term_start)||l(null===(d=t.dataList[e.index].markInfo[h])||void 0===d?void 0:d.aspect_term_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,s=a.t1_end,n=a.t2_start,o=a.t2_end,r=a.aspect_term_start,l=a.aspect_term_end;e.text.anchorOffse==n&&e.text.focusOffset==o&&t.dataList[e.index].markInfo[h].t1_start==i&&t.dataList[e.index].markInfo[h].t1_end==s&&t.dataList[e.index].markInfo[h].aspect_term_start==r&&t.dataList[e.index].markInfo[h].aspect_term_end==l&&(f=!0)})),f)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[h]={t1:"",t1_start:"",t1_end:"",t2:e.text.text,t2_start:e.text.anchorOffse,t2_end:e.text.focusOffset,aspect_term:"",aspect_term_start:"",aspect_term_end:"",aspect:"",opinion:"",status:1}}}for(var u=t.dataList[e.index].corpus1.split(""),p=0;p<t.dataList[e.index].markInfo.length;p++){var m=t.dataList[e.index].markInfo[p].t1_start,g=t.dataList[e.index].markInfo[p].t1_end;m===g-1?u[m]='<span index="'.concat(p,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[m],"</span>"):(u[m]='<span index="'.concat(p,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[m]),u[g-1]="".concat(t.dataList[e.index].corpus1[g-1],"</span>"));var v=t.dataList[e.index].markInfo[p].t2_start,b=t.dataList[e.index].markInfo[p].t2_end;v===b-1?u[v]='<span index="'.concat(p,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[v],"</span>"):(u[v]='<span index="'.concat(p,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[v]),u[b-1]="".concat(t.dataList[e.index].corpus1[b-1],"</span>"));var w=t.dataList[e.index].markInfo[p].aspect_term_start,y=t.dataList[e.index].markInfo[p].aspect_term_end;w===y-1?u[w]='<span index="'.concat(p,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[w],"</span>"):(u[w]='<span index="'.concat(p,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[w]),u[y-1]="".concat(t.dataList[e.index].corpus1[y-1],"</span>")),t.dataList[e.index].markInfo[p].index=p}t.dataList[e.index].corpus=u.join("")}else MessageService.showWarning("选定数据存在重复")},attributeFun:function(e){var a=!1,i=!1;if(t.dataList[e.index].markInfo&&t.dataList[e.index].markInfo.forEach((function(t){var s=t.t1_start,n=t.t1_end,o=t.t2_start,r=t.t2_end,l=t.aspect_term_start,c=t.aspect_term_end;e.text.anchorOffse>s&&e.text.anchorOffse<n&&(a=!0),e.text.focusOffset>s&&e.text.focusOffset<n&&(a=!0),e.text.anchorOffse>o&&e.text.anchorOffse<r&&(a=!0),e.text.focusOffset>o&&e.text.focusOffset<r&&(a=!0),e.text.anchorOffse>l&&e.text.anchorOffse<c&&(a=!0),e.text.focusOffset>l&&e.text.focusOffset<c&&(a=!0),e.text.anchorOffse==s&&e.text.focusOffset==n&&(i=!0),e.text.anchorOffse==o&&e.text.focusOffset==r&&(i=!0),e.text.anchorOffse==l&&e.text.focusOffset==c&&(i=!0)})),!a||i){if(null==t.dataList[e.index].markInfo||""==t.dataList[e.index].markInfo)t.dataList[e.index].markInfo=[{t1:"",t1_start:"",t1_end:"",t2:"",t2_start:"",t2_end:"",aspect_term:e.text.text,aspect_term_start:e.text.anchorOffse,aspect_term_end:e.text.focusOffset,aspect:"",opinion:"",status:1}];else{var s=t.dataList[e.index].markInfo.findIndex((function(t){return 1==t.status}));if(-1!=s){var n=!1;if(l(t.dataList[e.index].markInfo[s].t2_start)||l(t.dataList[e.index].markInfo[s].t2_end)||l(t.dataList[e.index].markInfo[s].t1_start)||l(t.dataList[e.index].markInfo[s].t1_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,o=a.t1_end,r=a.t2_start,l=a.t2_end,c=a.aspect_term_start,d=a.aspect_term_end;e.text.anchorOffse==c&&e.text.focusOffset==d&&t.dataList[e.index].markInfo[s].t2_start==r&&t.dataList[e.index].markInfo[s].t2_end==l&&t.dataList[e.index].markInfo[s].t1_start==i&&t.dataList[e.index].markInfo[s].t1_end==o&&(n=!0)})),n)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[s].aspect_term=e.text.text,t.dataList[e.index].markInfo[s].aspect_term_start=e.text.anchorOffse,t.dataList[e.index].markInfo[s].aspect_term_end=e.text.focusOffset}else{var o,r,c,d,h=t.dataList[e.index].markInfo.length,f=!1;if(l(null===(o=t.dataList[e.index].markInfo[h])||void 0===o?void 0:o.t2_start)||l(null===(r=t.dataList[e.index].markInfo[h])||void 0===r?void 0:r.t2_end)||l(null===(c=t.dataList[e.index].markInfo[h])||void 0===c?void 0:c.t1_start)||l(null===(d=t.dataList[e.index].markInfo[h])||void 0===d?void 0:d.t1_end)||t.dataList[e.index].markInfo.forEach((function(a){var i=a.t1_start,s=a.t1_end,n=a.t2_start,o=a.t2_end,r=a.aspect_term_start,l=a.aspect_term_end;e.text.anchorOffse==r&&e.text.focusOffset==l&&t.dataList[e.index].markInfo[h].t2_start==n&&t.dataList[e.index].markInfo[h].t2_end==o&&t.dataList[e.index].markInfo[h].t1_start==i&&t.dataList[e.index].markInfo[h].t1_end==s&&(f=!0)})),f)return void MessageService.showWarning("选定数据存在重复");t.dataList[e.index].markInfo[h]={t1:"",t1_start:"",t1_end:"",t2:"",t2_start:"",t2_end:"",aspect_term:e.text.text,aspect_term_start:e.text.anchorOffse,aspect_term_end:e.text.focusOffset,aspect:"",opinion:"",status:1}}}for(var u=t.dataList[e.index].corpus1.split(""),p=0;p<t.dataList[e.index].markInfo.length;p++){var m=t.dataList[e.index].markInfo[p].t1_start,g=t.dataList[e.index].markInfo[p].t1_end;m===g-1?u[m]='<span index="'.concat(p,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[m],"</span>"):(u[m]='<span index="'.concat(p,'" style="color: #D81159;">').concat(t.dataList[e.index].corpus1[m]),u[g-1]="".concat(t.dataList[e.index].corpus1[g-1],"</span>"));var v=t.dataList[e.index].markInfo[p].t2_start,b=t.dataList[e.index].markInfo[p].t2_end;v===b-1?u[v]='<span index="'.concat(p,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[v],"</span>"):(u[v]='<span index="'.concat(p,'" style="color: #D1B6E1;">').concat(t.dataList[e.index].corpus1[v]),u[b-1]="".concat(t.dataList[e.index].corpus1[b-1],"</span>"));var w=t.dataList[e.index].markInfo[p].aspect_term_start,y=t.dataList[e.index].markInfo[p].aspect_term_end;w===y-1?u[w]='<span index="'.concat(p,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[w],"</span>"):(u[w]='<span index="'.concat(p,'" style="color: #218380;">').concat(t.dataList[e.index].corpus1[w]),u[y-1]="".concat(t.dataList[e.index].corpus1[y-1],"</span>")),t.dataList[e.index].markInfo[p].index=p}t.dataList[e.index].corpus=u.join("")}else MessageService.showWarning("选定数据存在重复")}}}}}},d=c,h=(a("0a1d"),a("2877")),f=Object(h["a"])(d,i,s,!1,null,"0b3d3f98",null);e["default"]=f.exports},a3b5:function(t,e,a){},b2b7:function(t,e,a){"use strict";a.r(e),a.d(e,"isElementNode",(function(){return s})),a.d(e,"svgComponent",(function(){return o}));var i=Object.assign||function(t){for(var e,a=1,i=arguments.length;a<i;a++)for(var s in e=arguments[a],e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},s=function(t){return t.hasOwnProperty("tag")};function n(t,e){if(s(e)){var a=[];return e.children&&(a=e.children.map((function(e){return n(t,e)}))),t(e.tag,{attrs:e.attrsMap},a)}return e.text}var o=function(t){var e={props:{scale:{type:[Number,Boolean],default:1,required:!1},fill:{type:String,default:"currentColor",required:!1}},inheritAttrs:!1,computed:{dimension:function(){if(!this.scale||!t.attrsMap||!t.attrsMap.viewBox)return{};var e=t.attrsMap.viewBox.split(" ");return{width:Math.floor(parseInt(e[2])*this.scale),height:Math.floor(parseInt(e[3])*this.scale)}}},render:function(e){var a=this.scale?this.dimension:{},s=i({},t.attrsMap,{"aria-hidden":"true",fill:this.fill},a,this.$attrs);return e(t.tag,{attrs:s,on:this.$listeners},[this.$slots.default].concat((t.children||[]).map((function(t){return n(e,t)}))))}};return e}},c729:function(t,e,a){},ce32:function(t,e,a){"use strict";var i=a("0d20"),s=a.n(i);s.a},e786:function(t,e,a){"use strict";var i=a("c729"),s=a.n(i);s.a}}]);